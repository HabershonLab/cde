\hypertarget{namespacerpath}{}\section{rpath Module Reference}
\label{namespacerpath}\index{rpath@{rpath}}


Reaction-\/path object definition.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structrpath_1_1fingerprint}{fingerprint}}
\begin{DoxyCompactList}\small\item\em Type definition for the fingerprint of a reaction-\/path. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structrpath_1_1rxp}{rxp}}
\begin{DoxyCompactList}\small\item\em Type definition for the reaction-\/path object. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacerpath_ab6d6281ea4bcaee28c63f8d7d38e746a}{newpath}} (rp, startfrompath, startfile, endfile, pathfile, nimage, pathinit, emptypath, natom)
\begin{DoxyCompactList}\small\item\em New\+Path. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ad6c77a07ce6a59e54a4774305efe44d4}{copypath}} (rpin, rpout)
\begin{DoxyCompactList}\small\item\em Copy\+Path. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_acc28b3649c7753a676d4d6c4e6635286}{deletepath}} (rp)
\begin{DoxyCompactList}\small\item\em Delete\+Path. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a14303787a571dd0cb770f37003d45bc6}{setinternalcoords}} (rp, pathinit)
\begin{DoxyCompactList}\small\item\em Set\+Internal\+Coords. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a04757ca5d0ed595868763b0883801c03}{printpathtofile}} (rp, filename)
\begin{DoxyCompactList}\small\item\em Print\+Path\+To\+File. \end{DoxyCompactList}\item 
logical function, dimension(rp\%na) \mbox{\hyperlink{namespacerpath_a78a0f8974549227aa339b790407b8c60}{atomsingraphchanged}} (rp)
\begin{DoxyCompactList}\small\item\em Atoms\+In\+Graph\+Change. \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{namespacerpath_a737b05b4102dd39fe9fb25544f8cef5b}{molidofatom}} (atid, cx)
\begin{DoxyCompactList}\small\item\em Mol\+Id\+From\+Atom. \end{DoxyCompactList}\item 
character(\+:) function, allocatable \mbox{\hyperlink{namespacerpath_acfcfa66e72c2f1bd9fd7605b1dbf0c9c}{rpbondbreakmakelabel}} (rp, symmetric)
\begin{DoxyCompactList}\small\item\em R\+P\+Bond\+Break\+Make\+Label. \end{DoxyCompactList}\item 
double precision function \mbox{\hyperlink{namespacerpath_a6790b5358cce92bedc4c75dab38d780d}{molecularmass}} (cx, molid)
\begin{DoxyCompactList}\small\item\em Molecular\+Mass. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacerpath_ac1b5ae45f749a370ebab759dbaeeefd7}{validmolecularvalency}} (rp, cx, ic)
\begin{DoxyCompactList}\small\item\em Valid\+Molecular\+Valency. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacerpath_af041cd0a3cf96707ba0d0588a00c9e0f}{validmoleculevalency}} (cx, m)
\begin{DoxyCompactList}\small\item\em Valid\+Molecule\+Valency. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a3c3083be4489b8e7ed7330dcc26fb62f}{findidpppath}} (rp)
\begin{DoxyCompactList}\small\item\em Find\+I\+D\+P\+P\+Path. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a691c70e4854e7529a7b85e69491cdccc}{getforcenorm}} (rp, forcenorm, fmax, n1, n2)
\begin{DoxyCompactList}\small\item\em Get\+Force\+Norm. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacerpath_a5c4298880a886889f8edc93c7735c5b1}{checkmolecularvalency}} (cx, m, v)
\begin{DoxyCompactList}\small\item\em Check\+Molecular\+Valency. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacerpath_a89f260bcfddda4d489828af14c2651e7}{usingessentialatoms}} (rp, cx, ic, imove)
\begin{DoxyCompactList}\small\item\em Using\+Essential\+Atoms. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a2e0e1a6e2688c61a90654578a1f3e039}{getorderedactivemolecules}} (cx, Molec\+Act, nactmol, Active\+Atom)
\begin{DoxyCompactList}\small\item\em Get\+Ordered\+Active\+Molecules. \end{DoxyCompactList}\item 
character(\+:) function, allocatable \mbox{\hyperlink{namespacerpath_aaa967f303c4ed7b7f102c7dad27ab206}{chemicalequation}} (rp, sym)
\begin{DoxyCompactList}\small\item\em Chemical\+Equation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a50f2511a42a3608e9eab945405ba1a93}{printpathchemreactofile}} (rp, filename, path\+\_\+id, imove, ic, optaftermove)
\begin{DoxyCompactList}\small\item\em Print\+Path\+Chem\+Reac\+To\+File. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a2b31a5d2057f07a4b4e50d900e7287cc}{printpathchemreactofile2}} (rp, fngr, filename, path\+\_\+id, imove, ic, optaftermove)
\begin{DoxyCompactList}\small\item\em Print\+Path\+Chem\+Reac\+To\+File2. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a336b6f37b5f3c99709d0141d4b73eeb5}{getpathfingerprints}} (rp, imove, ic, fngr, optaftermove)
\begin{DoxyCompactList}\small\item\em Get\+Path\+Finger\+Prints. \end{DoxyCompactList}\item 
character(250) function, dimension(nactmol) \mbox{\hyperlink{namespacerpath_aaae5063ee23b5ff91882fb6eeafd4d05}{getsmilesforactivemolecules}} (cx, nactmol, Molec\+Act)
\begin{DoxyCompactList}\small\item\em Get\+Smiles\+For\+Active\+Molecules. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_aba836ec30e7b0733327d8f2949e4b00c}{readxyzframe}} (fileid, na, label, x, y, z)
\begin{DoxyCompactList}\small\item\em Read\+X\+Y\+Z\+Frame. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a9c5a494d479b12f65ad8913faf4f4028}{reorientsyscooforneb}} (rp)
\begin{DoxyCompactList}\small\item\em Reorient\+System\+For\+N\+EB. \end{DoxyCompactList}\item 
double precision function, dimension(3) \mbox{\hyperlink{namespacerpath_a5d207ca62bfc4e1fa21f80f112ebaa08}{xproduct}} (a, b)
\begin{DoxyCompactList}\small\item\em xproduct \end{DoxyCompactList}\item 
double precision function, dimension(3, 3) \mbox{\hyperlink{namespacerpath_a12b369bd567aeaa3c22e2d2edccf1061}{rotmatfromvecatob}} (vecA, vecB)
\begin{DoxyCompactList}\small\item\em Rot\+Matfrom\+Vec\+AtoB. \end{DoxyCompactList}\item 
real function \mbox{\hyperlink{namespacerpath_a9e31b64b8c7ca2095afd9fc69f8e944b}{finddet}} (matrixin, n)
\begin{DoxyCompactList}\small\item\em Find\+Det. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_abde80fc3058f25748933e535857b3913}{startfromendpoints}} (rp, startfile, endfile, pathinit, nimage)
\begin{DoxyCompactList}\small\item\em Start\+From\+End\+Points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a06918a9ef3a6a733a078f2d7142ca2e3}{readpathfromfile}} (rp, pathfile)
\begin{DoxyCompactList}\small\item\em Read\+Path\+From\+File. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_afeb43b9e8aed2543261318d3585a0832}{setpathconstraints}} (rp, N\+D\+O\+Fconstr, Fixed\+D\+OF, Natomconstr, Fixedatom)
\begin{DoxyCompactList}\small\item\em Set\+Path\+Constraints. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ac8b51bb543056270fc034d75ba2a7266}{getpathenergy}} (rp, success)
\begin{DoxyCompactList}\small\item\em Get\+Path\+Energy. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a1faa43d82cebd49dbfb23e87189db2c2}{getprojforces1}} (rp, kon, ci\+\_\+flag, endflag)
\begin{DoxyCompactList}\small\item\em Get\+Proj\+Forces1. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ac95367fc9bf411eca8d31874d5e3e703}{getprojforces2}} (rp, kon, ci\+\_\+flag, endflag)
\begin{DoxyCompactList}\small\item\em Get\+Proj\+Forces2. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{namespacerpath_a73d1e89cffa30d46b66bfbd445e3e0f4}\label{namespacerpath_a73d1e89cffa30d46b66bfbd445e3e0f4}} 
subroutine {\bfseries variablesprings} (rp)
\item 
subroutine \mbox{\hyperlink{namespacerpath_a79ee81833120305547c237a755918472}{getprojforces3}} (rp, kon, ci\+\_\+flag, endflag)
\begin{DoxyCompactList}\small\item\em Get\+Proj\+Forces3. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_aae808f74fd2e658a175c79600c5bfe34}{shimmyendbeads}} (rp, shimmied, beadcount, pend)
\begin{DoxyCompactList}\small\item\em Shimmy\+End\+Beads. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ae42b5c49527891229d00dfab8a17bd90}{loosenspringofflatmiddle}} (rp, loosened, beadcount)
\begin{DoxyCompactList}\small\item\em Loosen\+Spring\+Of\+Flat\+Middle (C\+U\+R\+R\+E\+N\+T\+LY N\+OT U\+S\+ED....D\+I\+D\+NT R\+E\+A\+L\+LY W\+O\+RK..) \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a17575cd0e216ffd99d188bb982fd2efc}{getfourierforces}} (rp)
\begin{DoxyCompactList}\small\item\em Get\+Fourier\+Forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a8808a2a9ef2cd749de76ec66e662cf4c}{fouriertopath}} (rp)
\begin{DoxyCompactList}\small\item\em Fourier\+To\+Path. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a58f6e30e1af43edf4aa86279c520213f}{pathtofourier}} (rp)
\begin{DoxyCompactList}\small\item\em Path\+To\+Fourier. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_aa76074b978980fcf3419586f037a4385}{getcoeffmomenta}} (rp, temperature, mass, irun)
\begin{DoxyCompactList}\small\item\em Get\+Coeff\+Momenta. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a7fee98f4bae0eeddfeb9c7a7a0cd36de}{firstvvupdate}} (rp, timestep, mass)
\begin{DoxyCompactList}\small\item\em First\+V\+V\+Update. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ac85f7c72e6a51be0d86bde43398f5d1b}{secondvvupdate}} (rp, timestep, mass)
\begin{DoxyCompactList}\small\item\em Second\+V\+V\+Update. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ae05b8e955144357569094f22cb55b245}{getspringforces}} (rp, kspring)
\begin{DoxyCompactList}\small\item\em Get\+Spring\+Forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a89297ca90bf4171b4d1ac5a941e80a50}{removepathcollisions}} (rp, ngdsrelax, gdsdtrelax, nbstrength, gdsrestspring, nbrange)
\begin{DoxyCompactList}\small\item\em Remove\+Collisions. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a75785c13dc36360c86c2ef8e8dd11fad}{minimisecollision}} (rp, ngdsrelax, gdsdtrelax, nbstrength, gdsrestspring, nbrange, rmin, rmax, na, im1, im2)
\begin{DoxyCompactList}\small\item\em Minimise\+Collision. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_aa844bacf78aac643d982ebb18988dbb6}{stripinactivefrompath}} (rp, stripfile, Fixed\+D\+OF, Fixed\+Atom, N\+D\+O\+Fconstr, Natomconstr)
\begin{DoxyCompactList}\small\item\em Strip\+Inactive\+From\+Path. \end{DoxyCompactList}\item 
real(8) function \mbox{\hyperlink{namespacerpath_a4c7410e4e6417ef235293315107537e8}{errorr}} (one, two, na)
\begin{DoxyCompactList}\small\item\em errorr calculates the absolute difference, elementwise between two matrices. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a37439f39e5934c023cbc1ce46a641de9}{geteulermatrices}} (lh, phi, theta, psi)
\begin{DoxyCompactList}\small\item\em Get\+Euler\+Matrices. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a57a80823cabeccdde83680731d65d88e}{getidpppathweightsdis}} (rp, adpp, H\+I\+D\+PP)
\begin{DoxyCompactList}\small\item\em Get\+I\+D\+P\+P\+Path\+Weights\+Dis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a40c08338c270399cecf65a4f2e6b858d}{getidppinterpdistance}} (rp, ids)
\begin{DoxyCompactList}\small\item\em Get\+I\+D\+P\+P\+Interp\+Distance. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a65a712550505b1542b4f01af95a18c1a}{getidppforces}} (rp, adpp, ids, H\+I\+D\+PP)
\begin{DoxyCompactList}\small\item\em Get\+I\+D\+P\+P\+Forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a4749f3881a10626d54544110e0eb1cba}{geninterpol}} (rp, idpppath, rad\+\_\+min, callgather)
\begin{DoxyCompactList}\small\item\em Gen\+Interpol. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a2e9f77deb07ac9c56b2068eaf7853a4a}{optimisereactivemolecules}} (rp, success, itmp, imove)
\begin{DoxyCompactList}\small\item\em Optimise\+Reactive\+Molecules. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacerpath_aafdcf74818568a7573511f5205a558e0}{moleculevalid}} (cx, ograph)
\begin{DoxyCompactList}\small\item\em Molecule\+Valid. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a1af24f3421dc3b87b062668f04eaee22}{printmolecularenergies}} (rp, filename)
\begin{DoxyCompactList}\small\item\em Print\+Molecular\+Energies. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ab03d1a925ddda8a471cc0faf8bc393c6}{getactmolecenergies}} (cx, Molec\+Act, nactmol, molen)
\begin{DoxyCompactList}\small\item\em Get\+Act\+Molecular\+Energies. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a9499e691ae9b7d354e0c84bb147b41ab}{gatherreactivemolecules}} (rp, rad\+\_\+min)
\begin{DoxyCompactList}\small\item\em Gather\+Reactive\+Nolecules. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a259f0a538ae15f09680183f2a259da58}{addtomoleculardatabase}} (rp, fngr, Md, itot)
\begin{DoxyCompactList}\small\item\em Add\+To\+Molecular\+Database. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a8d4afda6b550a4857b9800f7d94cb87b}{savemoleculardatabase}} (Md, filename)
\begin{DoxyCompactList}\small\item\em Save\+Molecular\+Database. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a296f9413787464666a45c1433ea90a32}{readmoleculardatabase}} (Md, filename)
\begin{DoxyCompactList}\small\item\em Read\+Molecular\+Database. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a1163d0179108c7da7f7b0590d9a5b911}{printmoleculardatabase}} (Md, filename)
\begin{DoxyCompactList}\small\item\em Print\+Molecular\+Database. \end{DoxyCompactList}\item 
character(\+:) function, allocatable \mbox{\hyperlink{namespacerpath_ad5763afa90216356bb2694841d938592}{molecularformula}} (cx, molid)
\begin{DoxyCompactList}\small\item\em Molecular\+Formula. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a3ea5ea388547f210105034dd8fdab394}{printpathchemreactofile}} (rp, filename, path\+\_\+id, imove, ic)
\begin{DoxyCompactList}\small\item\em Print\+Path\+To\+File. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_ab5e5d395f73dd82e69efa6977b748dc9}{getpathfingerprints}} (rp, imove, ic, fngr)
\begin{DoxyCompactList}\small\item\em Get\+Path\+Finger\+Prints. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a94586723a045fa2d44e3f6b6a91d1d50}{getprojectedforces}} (rp, kspring, ci\+\_\+flag, endflag, variablespring)
\begin{DoxyCompactList}\small\item\em Get\+Projected\+Forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerpath_a77818427a2d3efbe627d872dd929e11e}{getprojforces}} (rp, kspring, ci\+\_\+flag, endflag, variablespring)
\begin{DoxyCompactList}\small\item\em Get\+Proj\+Forces. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Reaction-\/path object definition. 

Defines the reaction-\/path object type. This object is a string of nimage snapshots along a reaction-\/path. 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacerpath_ab6d6281ea4bcaee28c63f8d7d38e746a}\label{namespacerpath_ab6d6281ea4bcaee28c63f8d7d38e746a}} 
\index{rpath@{rpath}!newpath@{newpath}}
\index{newpath@{newpath}!rpath@{rpath}}
\subsubsection{\texorpdfstring{newpath()}{newpath()}}
{\footnotesize\ttfamily subroutine rpath\+::newpath (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical, intent(in)}]{startfrompath,  }\item[{character, dimension($\ast$), intent(in)}]{startfile,  }\item[{character, dimension($\ast$), intent(in)}]{endfile,  }\item[{character, dimension($\ast$), intent(in)}]{pathfile,  }\item[{integer}]{nimage,  }\item[{character, dimension($\ast$), intent(in)}]{pathinit,  }\item[{logical, intent(in)}]{emptypath,  }\item[{integer}]{natom }\end{DoxyParamCaption})}



New\+Path. 

Initializes a path object.


\begin{DoxyItemize}
\item rp\+: Initialized path object.
\item startfrompath\+: Flag to indicate that we\textquotesingle{}re starting from a full path (logical)
\item startfile\+: filename for starting point structure (xyz file)
\item endfile\+: filename for end point structure (xyz file)
\item pathfile\+: If startfrompath == .T\+R\+UE., read the full path from pathfile
\item nimage\+: number of images along path in total (read from input file OR from pathfile)
\item pathinit\+: path initialization type when startfrompath = .F\+A\+L\+SE.. Allowed values are \textquotesingle{}L\+I\+N\+E\+AR\textquotesingle{} and ....?
\item emptypath\+: Flag indicating whether to start with an empty path.
\item natom\+: number of atoms. 
\end{DoxyItemize}

Definition at line 75 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ad6c77a07ce6a59e54a4774305efe44d4}\label{namespacerpath_ad6c77a07ce6a59e54a4774305efe44d4}} 
\index{rpath@{rpath}!copypath@{copypath}}
\index{copypath@{copypath}!rpath@{rpath}}
\subsubsection{\texorpdfstring{copypath()}{copypath()}}
{\footnotesize\ttfamily subroutine rpath\+::copypath (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rpin,  }\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rpout }\end{DoxyParamCaption})}



Copy\+Path. 

Creates an empty reaction path, rpout, using parameter sizes from rpin


\begin{DoxyItemize}
\item rpin\+: The reaction path object used to get size information.
\item rpout\+: The new reaction path object. 
\end{DoxyItemize}

Definition at line 143 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_acc28b3649c7753a676d4d6c4e6635286}\label{namespacerpath_acc28b3649c7753a676d4d6c4e6635286}} 
\index{rpath@{rpath}!deletepath@{deletepath}}
\index{deletepath@{deletepath}!rpath@{rpath}}
\subsubsection{\texorpdfstring{deletepath()}{deletepath()}}
{\footnotesize\ttfamily subroutine rpath\+::deletepath (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Delete\+Path. 

Deletes memory associated with a path.


\begin{DoxyItemize}
\item rp\+: The reaction path object to be deleted. 
\end{DoxyItemize}

Definition at line 170 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a14303787a571dd0cb770f37003d45bc6}\label{namespacerpath_a14303787a571dd0cb770f37003d45bc6}} 
\index{rpath@{rpath}!setinternalcoords@{setinternalcoords}}
\index{setinternalcoords@{setinternalcoords}!rpath@{rpath}}
\subsubsection{\texorpdfstring{setinternalcoords()}{setinternalcoords()}}
{\footnotesize\ttfamily subroutine rpath\+::setinternalcoords (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{pathinit }\end{DoxyParamCaption})}



Set\+Internal\+Coords. 

When building a path from end-\/points only, this subroutine sets the coordinates of the nimage-\/2 internal beads according to the method defined in pathinit.


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item pathinit\+: string defining interpolation type. Allowed values are \textquotesingle{}L\+I\+N\+E\+AR\textquotesingle{} for linear interpolation.. 
\end{DoxyItemize}

Definition at line 210 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a04757ca5d0ed595868763b0883801c03}\label{namespacerpath_a04757ca5d0ed595868763b0883801c03}} 
\index{rpath@{rpath}!printpathtofile@{printpathtofile}}
\index{printpathtofile@{printpathtofile}!rpath@{rpath}}
\subsubsection{\texorpdfstring{printpathtofile()}{printpathtofile()}}
{\footnotesize\ttfamily subroutine rpath\+::printpathtofile (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{filename }\end{DoxyParamCaption})}



Print\+Path\+To\+File. 

Outputs an entire reaction path to an xyz file.


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item filename\+: the output xyz file. 
\end{DoxyItemize}

Definition at line 252 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a78a0f8974549227aa339b790407b8c60}\label{namespacerpath_a78a0f8974549227aa339b790407b8c60}} 
\index{rpath@{rpath}!atomsingraphchanged@{atomsingraphchanged}}
\index{atomsingraphchanged@{atomsingraphchanged}!rpath@{rpath}}
\subsubsection{\texorpdfstring{atomsingraphchanged()}{atomsingraphchanged()}}
{\footnotesize\ttfamily logical function, dimension(rp\%na) rpath\+::atomsingraphchanged (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Atoms\+In\+Graph\+Change. 

Identify which atoms have changed bonding. Returns Atoms\+In\+Graph\+Change an array of logicals


\begin{DoxyItemize}
\item rp\+: The reaction path object. 
\end{DoxyItemize}

Definition at line 284 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a737b05b4102dd39fe9fb25544f8cef5b}\label{namespacerpath_a737b05b4102dd39fe9fb25544f8cef5b}} 
\index{rpath@{rpath}!molidofatom@{molidofatom}}
\index{molidofatom@{molidofatom}!rpath@{rpath}}
\subsubsection{\texorpdfstring{molidofatom()}{molidofatom()}}
{\footnotesize\ttfamily integer function rpath\+::molidofatom (\begin{DoxyParamCaption}\item[{integer}]{atid,  }\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx }\end{DoxyParamCaption})}



Mol\+Id\+From\+Atom. 

Tells you which molecule the atom belogs to. Returns the ID of that molecule


\begin{DoxyItemize}
\item cx\+: chemical structure
\item atid\+: atom index 
\end{DoxyItemize}

Definition at line 311 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_acfcfa66e72c2f1bd9fd7605b1dbf0c9c}\label{namespacerpath_acfcfa66e72c2f1bd9fd7605b1dbf0c9c}} 
\index{rpath@{rpath}!rpbondbreakmakelabel@{rpbondbreakmakelabel}}
\index{rpbondbreakmakelabel@{rpbondbreakmakelabel}!rpath@{rpath}}
\subsubsection{\texorpdfstring{rpbondbreakmakelabel()}{rpbondbreakmakelabel()}}
{\footnotesize\ttfamily character(\+:) function, allocatable rpath\+::rpbondbreakmakelabel (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{symmetric }\end{DoxyParamCaption})}



R\+P\+Bond\+Break\+Make\+Label. 

Outputs a string displaying which bonds are broken made


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item symmetric\+: if True, it prints a label \char`\"{}.\char`\"{} with ignores the direction of the reaction if False, then it will print \char`\"{}-\/\char`\"{} for bond formation or \char`\"{}x\char`\"{} for bond breaking 
\end{DoxyItemize}

Definition at line 352 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a6790b5358cce92bedc4c75dab38d780d}\label{namespacerpath_a6790b5358cce92bedc4c75dab38d780d}} 
\index{rpath@{rpath}!molecularmass@{molecularmass}}
\index{molecularmass@{molecularmass}!rpath@{rpath}}
\subsubsection{\texorpdfstring{molecularmass()}{molecularmass()}}
{\footnotesize\ttfamily double precision function rpath\+::molecularmass (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{molid }\end{DoxyParamCaption})}



Molecular\+Mass. 

Returns the mass of a molecule molid in cx


\begin{DoxyItemize}
\item cx\+: Chemical structure
\item molid\+: id of the molecule in cx 
\end{DoxyItemize}

Definition at line 424 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ac1b5ae45f749a370ebab759dbaeeefd7}\label{namespacerpath_ac1b5ae45f749a370ebab759dbaeeefd7}} 
\index{rpath@{rpath}!validmolecularvalency@{validmolecularvalency}}
\index{validmolecularvalency@{validmolecularvalency}!rpath@{rpath}}
\subsubsection{\texorpdfstring{validmolecularvalency()}{validmolecularvalency()}}
{\footnotesize\ttfamily logical function rpath\+::validmolecularvalency (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{ic }\end{DoxyParamCaption})}



Valid\+Molecular\+Valency. 

Checks if the molecular valency constraints are met, as given by the user for every molecule, it check every set to see if it passes or not the constraint it determines the valency by sequentially adding one bond to each bonded pair the atoms without the correct valency at the end are added up and checked if the user allowed for such a \char`\"{}charge\char`\"{} to be present in molecules the contraints priority is determined by their order in the list -\/ whichevery contraint is the first one that applies to it, will determine if the molecule is acceptable or not. if the molecule passes a single one of these contraints, its considered acceptable A\+LL the atoms in the molecule must belong to the set, for that set contraint to apply to it for molecules with elements \char`\"{}-\/x\char`\"{} those elements are \char`\"{}removed\char`\"{} and the submolecules are then judged.


\begin{DoxyItemize}
\item rp\+: Reaction path-\/ needed to determine which molecules are involved in the reaction
\item cx\+: the proposed chemical structure that will become part of rp
\item ic\+: wheather cx is the head or tail of rp
\item valid\+: returns true if its a valis molecular valency structure cx
\end{DoxyItemize}

Checks if the molecular valency constraints are met, as given by the user for every molecule, it check every set to see if it passes or not the constraint it determines the valency by sequentially adding one bond to each bonded pair the atoms without the correct valency at the end are added up and checked if the user allowed for such a \char`\"{}charge\char`\"{} to be present in molecules the contraints priority is determined by their order in the list -\/ whichevery contraint is the first one that applies to it, will determine if the molecule is acceptable or not. if the molecule passes a single one of these contraints, its considered acceptable A\+LL the atoms in the molecule must belong to the set, for that set contraint to apply to it


\begin{DoxyItemize}
\item rp\+: Reaction path-\/ needed to determine which molecules are involved in the reaction
\item cx\+: the proposed chemical structure that will become part of rp
\item ic\+: wheather cx is the head or tail of rp
\item valid\+: returns true if its a valis molecular valency structure cx 
\end{DoxyItemize}

Definition at line 459 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_af041cd0a3cf96707ba0d0588a00c9e0f}\label{namespacerpath_af041cd0a3cf96707ba0d0588a00c9e0f}} 
\index{rpath@{rpath}!validmoleculevalency@{validmoleculevalency}}
\index{validmoleculevalency@{validmoleculevalency}!rpath@{rpath}}
\subsubsection{\texorpdfstring{validmoleculevalency()}{validmoleculevalency()}}
{\footnotesize\ttfamily logical function rpath\+::validmoleculevalency (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{m }\end{DoxyParamCaption})}



Valid\+Molecule\+Valency. 

Checks if the molecular valency constraints are met, see Valid\+Molecular\+Valency


\begin{DoxyItemize}
\item cx\+: the proposed chemical structure that will become part of rp
\item m\+: molecule
\item valid\+: returns true if its a valis molecular valency structure cx 
\end{DoxyItemize}

Definition at line 501 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a3c3083be4489b8e7ed7330dcc26fb62f}\label{namespacerpath_a3c3083be4489b8e7ed7330dcc26fb62f}} 
\index{rpath@{rpath}!findidpppath@{findidpppath}}
\index{findidpppath@{findidpppath}!rpath@{rpath}}
\subsubsection{\texorpdfstring{findidpppath()}{findidpppath()}}
{\footnotesize\ttfamily subroutine rpath\+::findidpppath (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Find\+I\+D\+P\+P\+Path. 

finds an interpolated path using N\+EB on a Image-\/dependent Pair\+Potential, as described in Smidstrup et al J Chem phys 2014, 140


\begin{DoxyItemize}
\item rp\+: Reaction path 
\end{DoxyItemize}

Definition at line 564 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a691c70e4854e7529a7b85e69491cdccc}\label{namespacerpath_a691c70e4854e7529a7b85e69491cdccc}} 
\index{rpath@{rpath}!getforcenorm@{getforcenorm}}
\index{getforcenorm@{getforcenorm}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getforcenorm()}{getforcenorm()}}
{\footnotesize\ttfamily subroutine rpath\+::getforcenorm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{forcenorm,  }\item[{real(8)}]{fmax,  }\item[{integer}]{n1,  }\item[{integer}]{n2 }\end{DoxyParamCaption})}



Get\+Force\+Norm. 

Calculate the norm of the projected forces for the internal beads.


\begin{DoxyItemize}
\item rp\+: The reaction-\/path object to be refined.
\item forcenorm\+: Returned force norm
\item n1, n2\+: Integer range of images to include in calculation. 
\end{DoxyItemize}

Definition at line 656 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a5c4298880a886889f8edc93c7735c5b1}\label{namespacerpath_a5c4298880a886889f8edc93c7735c5b1}} 
\index{rpath@{rpath}!checkmolecularvalency@{checkmolecularvalency}}
\index{checkmolecularvalency@{checkmolecularvalency}!rpath@{rpath}}
\subsubsection{\texorpdfstring{checkmolecularvalency()}{checkmolecularvalency()}}
{\footnotesize\ttfamily logical function rpath\+::checkmolecularvalency (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{m,  }\item[{integer}]{v }\end{DoxyParamCaption})}



Check\+Molecular\+Valency. 

we check whether some molecule m in the structure cx, abides by rule indexed v see Valid\+Molecular\+Valency for general purpose. the elements are ranked with highest valencies on top. the valencies start to be counted until the valcon for the element is reached, upon which all bonds to it are \char`\"{}purged\char`\"{}. by the end of this procedure, any elements that were left without reachin its valcon means that some element had too many bonds/not enough. if the sum of this are greater than the offset ncharcon, then its not a valid molecule.


\begin{DoxyItemize}
\item rp\+: Reaction path-\/ needed to determine which molecules are involved in the reaction
\item cx\+: the proposed chemical structure that will become part of rp
\item ic\+: wheather cx is the head or tail of rp
\item valid\+: returns true if its a valis molecular valency structure cx 
\end{DoxyItemize}

Definition at line 710 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a89f260bcfddda4d489828af14c2651e7}\label{namespacerpath_a89f260bcfddda4d489828af14c2651e7}} 
\index{rpath@{rpath}!usingessentialatoms@{usingessentialatoms}}
\index{usingessentialatoms@{usingessentialatoms}!rpath@{rpath}}
\subsubsection{\texorpdfstring{usingessentialatoms()}{usingessentialatoms()}}
{\footnotesize\ttfamily logical function rpath\+::usingessentialatoms (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{ic,  }\item[{integer}]{imove }\end{DoxyParamCaption})}



Using\+Essential\+Atoms. 

Checks that the molecules that are involved in the proposed reaction have AT L\+E\+A\+ST O\+NE of the essential atoms specified.


\begin{DoxyItemize}
\item rp\+: Reaction path-\/ needed to determine which molecules are involved in the reaction
\item cx\+: the proposed chemical structure that will become part of rp
\item ic\+: wheather cx is the head or tail of rp
\item valid\+: returns true if true 
\end{DoxyItemize}

Definition at line 800 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a2e0e1a6e2688c61a90654578a1f3e039}\label{namespacerpath_a2e0e1a6e2688c61a90654578a1f3e039}} 
\index{rpath@{rpath}!getorderedactivemolecules@{getorderedactivemolecules}}
\index{getorderedactivemolecules@{getorderedactivemolecules}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getorderedactivemolecules()}{getorderedactivemolecules()}}
{\footnotesize\ttfamily subroutine rpath\+::getorderedactivemolecules (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer, dimension(cx\%nmol)}]{Molec\+Act,  }\item[{integer}]{nactmol,  }\item[{logical, dimension(cx\%na)}]{Active\+Atom }\end{DoxyParamCaption})}



Get\+Ordered\+Active\+Molecules. 

Returns an array of which molecules are active in the chemical structure, according to the Active\+Atoms logical array given. The order of molecules depends on Molecular mass and size


\begin{DoxyItemize}
\item cx\+: Chemical structure
\item Molec\+Act\+: Array of active molecules, in descending order given my molecular M\+A\+SS $>$ Molecular size
\item nactmol\+: total number of active molecules
\item Active\+Atom\+: logical array specifying which atoms are active during a reaction. 
\end{DoxyItemize}

Definition at line 866 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aaa967f303c4ed7b7f102c7dad27ab206}\label{namespacerpath_aaa967f303c4ed7b7f102c7dad27ab206}} 
\index{rpath@{rpath}!chemicalequation@{chemicalequation}}
\index{chemicalequation@{chemicalequation}!rpath@{rpath}}
\subsubsection{\texorpdfstring{chemicalequation()}{chemicalequation()}}
{\footnotesize\ttfamily character(\+:) function, allocatable rpath\+::chemicalequation (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{sym }\end{DoxyParamCaption})}



Chemical\+Equation. 

Outputs the information for the particular chemical equation the path represents


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item sym\+: If true, R\+P\+Bond\+Break\+Make\+Label does not determine if which is the reactant or which the product (see function) 
\end{DoxyItemize}

Definition at line 916 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a50f2511a42a3608e9eab945405ba1a93}\label{namespacerpath_a50f2511a42a3608e9eab945405ba1a93}} 
\index{rpath@{rpath}!printpathchemreactofile@{printpathchemreactofile}}
\index{printpathchemreactofile@{printpathchemreactofile}!rpath@{rpath}}
\subsubsection{\texorpdfstring{printpathchemreactofile()}{printpathchemreactofile()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily subroutine rpath\+::printpathchemreactofile (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{filename,  }\item[{integer}]{path\+\_\+id,  }\item[{integer}]{imove,  }\item[{integer}]{ic,  }\item[{logical}]{optaftermove }\end{DoxyParamCaption})}



Print\+Path\+Chem\+Reac\+To\+File. 

Outputs the chemical reaction onto filename providede with path\+\_\+id provdided


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item filename\+: the output xyz file.
\item path\+\_\+id\+: the id of the reaction path provided 
\end{DoxyItemize}

Definition at line 956 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a2b31a5d2057f07a4b4e50d900e7287cc}\label{namespacerpath_a2b31a5d2057f07a4b4e50d900e7287cc}} 
\index{rpath@{rpath}!printpathchemreactofile2@{printpathchemreactofile2}}
\index{printpathchemreactofile2@{printpathchemreactofile2}!rpath@{rpath}}
\subsubsection{\texorpdfstring{printpathchemreactofile2()}{printpathchemreactofile2()}}
{\footnotesize\ttfamily subroutine rpath\+::printpathchemreactofile2 (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{type(\mbox{\hyperlink{structrpath_1_1fingerprint}{fingerprint}})}]{fngr,  }\item[{character, dimension($\ast$)}]{filename,  }\item[{integer}]{path\+\_\+id,  }\item[{integer}]{imove,  }\item[{integer}]{ic,  }\item[{logical}]{optaftermove }\end{DoxyParamCaption})}



Print\+Path\+Chem\+Reac\+To\+File2. 

Outputs the chemical reaction onto filename providede from the fingerprint provided this version avoids recalculating molecular energies..


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item filename\+: the output xyz file.
\item path\+\_\+id\+: the id of the reaction path provided 
\end{DoxyItemize}

Definition at line 1066 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a336b6f37b5f3c99709d0141d4b73eeb5}\label{namespacerpath_a336b6f37b5f3c99709d0141d4b73eeb5}} 
\index{rpath@{rpath}!getpathfingerprints@{getpathfingerprints}}
\index{getpathfingerprints@{getpathfingerprints}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getpathfingerprints()}{getpathfingerprints()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily subroutine rpath\+::getpathfingerprints (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{integer}]{imove,  }\item[{integer}]{ic,  }\item[{type(\mbox{\hyperlink{structrpath_1_1fingerprint}{fingerprint}})}]{fngr,  }\item[{logical}]{optaftermove }\end{DoxyParamCaption})}



Get\+Path\+Finger\+Prints. 

returns a fingerprint derived type (see top \mbox{\hyperlink{rpath_8f90_source}{rpath.\+f90}}) with the \char`\"{}fingerprints\char`\"{} of the reaction path provided


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item imove\+: the graph move performed by this rp
\item ic\+: which end of the path underwent this move 
\end{DoxyItemize}

Definition at line 1176 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aaae5063ee23b5ff91882fb6eeafd4d05}\label{namespacerpath_aaae5063ee23b5ff91882fb6eeafd4d05}} 
\index{rpath@{rpath}!getsmilesforactivemolecules@{getsmilesforactivemolecules}}
\index{getsmilesforactivemolecules@{getsmilesforactivemolecules}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getsmilesforactivemolecules()}{getsmilesforactivemolecules()}}
{\footnotesize\ttfamily character(250) function, dimension(nactmol) rpath\+::getsmilesforactivemolecules (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{nactmol,  }\item[{integer, dimension(nactmol)}]{Molec\+Act }\end{DoxyParamCaption})}



Get\+Smiles\+For\+Active\+Molecules. 

Returns Mol\+Smiles, an array of characters with the Smiles strip for each molecule in Molec\+Act


\begin{DoxyItemize}
\item cx\+: Chemical structure
\item nactmol\+: number of active molecules in cx
\item Molec\+Act\+: array with indecies of the nactmol molecules that are active in this problem
\item Mol\+Smiles\+: array of nactmol Smiles strips 
\end{DoxyItemize}

Definition at line 1245 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aba836ec30e7b0733327d8f2949e4b00c}\label{namespacerpath_aba836ec30e7b0733327d8f2949e4b00c}} 
\index{rpath@{rpath}!readxyzframe@{readxyzframe}}
\index{readxyzframe@{readxyzframe}!rpath@{rpath}}
\subsubsection{\texorpdfstring{readxyzframe()}{readxyzframe()}}
{\footnotesize\ttfamily subroutine rpath\+::readxyzframe (\begin{DoxyParamCaption}\item[{integer}]{fileid,  }\item[{integer}]{na,  }\item[{character$\ast$2, dimension($\ast$)}]{label,  }\item[{real(8), dimension($\ast$)}]{x,  }\item[{real(8), dimension($\ast$)}]{y,  }\item[{real(8), dimension($\ast$)}]{z }\end{DoxyParamCaption})}



Read\+X\+Y\+Z\+Frame. 

reads a single frame from an xyz file.


\begin{DoxyItemize}
\item fileid\+: Integer file label.
\item na\+: Number of atoms
\item label\+: atom labes read from file.
\item x,y,z\+: Coordinates of each atom read from file 
\end{DoxyItemize}

Definition at line 1291 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a9c5a494d479b12f65ad8913faf4f4028}\label{namespacerpath_a9c5a494d479b12f65ad8913faf4f4028}} 
\index{rpath@{rpath}!reorientsyscooforneb@{reorientsyscooforneb}}
\index{reorientsyscooforneb@{reorientsyscooforneb}!rpath@{rpath}}
\subsubsection{\texorpdfstring{reorientsyscooforneb()}{reorientsyscooforneb()}}
{\footnotesize\ttfamily subroutine rpath\+::reorientsyscooforneb (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Reorient\+System\+For\+N\+EB. 

Translates and reorients the system by putting the heavyest three atoms in a plane and returns an array of three elements with the indecies of the three atoms that should be frozen during N\+EB algorithm to ensure the space of Rot/\+Trans \textquotesingle{}projected out\textquotesingle{}.


\begin{DoxyItemize}
\item rp\+: The reaction path object. 
\end{DoxyItemize}

Definition at line 1323 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a5d207ca62bfc4e1fa21f80f112ebaa08}\label{namespacerpath_a5d207ca62bfc4e1fa21f80f112ebaa08}} 
\index{rpath@{rpath}!xproduct@{xproduct}}
\index{xproduct@{xproduct}!rpath@{rpath}}
\subsubsection{\texorpdfstring{xproduct()}{xproduct()}}
{\footnotesize\ttfamily double precision function, dimension(3) rpath\+::xproduct (\begin{DoxyParamCaption}\item[{double precision, dimension(3)}]{a,  }\item[{double precision, dimension(3)}]{b }\end{DoxyParamCaption})}



xproduct 

cross product between 3d vectors, not for general space. returns vector


\begin{DoxyItemize}
\item a,b\+: vectors 
\end{DoxyItemize}

Definition at line 1482 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a12b369bd567aeaa3c22e2d2edccf1061}\label{namespacerpath_a12b369bd567aeaa3c22e2d2edccf1061}} 
\index{rpath@{rpath}!rotmatfromvecatob@{rotmatfromvecatob}}
\index{rotmatfromvecatob@{rotmatfromvecatob}!rpath@{rpath}}
\subsubsection{\texorpdfstring{rotmatfromvecatob()}{rotmatfromvecatob()}}
{\footnotesize\ttfamily double precision function, dimension(3,3) rpath\+::rotmatfromvecatob (\begin{DoxyParamCaption}\item[{double precision, dimension(3)}]{vecA,  }\item[{double precision, dimension(3)}]{vecB }\end{DoxyParamCaption})}



Rot\+Matfrom\+Vec\+AtoB. 

Finds the rotation matrix required to take vector A to vector B by M$\ast$A = B works for 3D vectors only...but more efficient than using the Kabsch algorithm.


\begin{DoxyItemize}
\item vecA, vecB\+: vectors 
\end{DoxyItemize}

Definition at line 1502 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a9e31b64b8c7ca2095afd9fc69f8e944b}\label{namespacerpath_a9e31b64b8c7ca2095afd9fc69f8e944b}} 
\index{rpath@{rpath}!finddet@{finddet}}
\index{finddet@{finddet}!rpath@{rpath}}
\subsubsection{\texorpdfstring{finddet()}{finddet()}}
{\footnotesize\ttfamily real function rpath\+::finddet (\begin{DoxyParamCaption}\item[{real(8), dimension(n,n)}]{matrixin,  }\item[{integer, intent(in)}]{n }\end{DoxyParamCaption})}



Find\+Det. 

Determinant of a matrix...


\begin{DoxyItemize}
\item matrix\+: matrix
\item n\+: dimensions 
\end{DoxyItemize}

Definition at line 1528 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_abde80fc3058f25748933e535857b3913}\label{namespacerpath_abde80fc3058f25748933e535857b3913}} 
\index{rpath@{rpath}!startfromendpoints@{startfromendpoints}}
\index{startfromendpoints@{startfromendpoints}!rpath@{rpath}}
\subsubsection{\texorpdfstring{startfromendpoints()}{startfromendpoints()}}
{\footnotesize\ttfamily subroutine rpath\+::startfromendpoints (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{startfile,  }\item[{character, dimension($\ast$)}]{endfile,  }\item[{character, dimension($\ast$)}]{pathinit,  }\item[{integer}]{nimage }\end{DoxyParamCaption})}



Start\+From\+End\+Points. 

Initializes a reaction path using the path end-\/points.


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item startfile\+: the xyz file containing the startpoint.
\item endfile\+: the xyz file containing the endpoint.
\item pathinit\+: character$\ast$5 string containing identifier for method used to interpolate internal image coordinates.
\item nimage\+: Number of images in path. 
\end{DoxyItemize}

Definition at line 1590 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a06918a9ef3a6a733a078f2d7142ca2e3}\label{namespacerpath_a06918a9ef3a6a733a078f2d7142ca2e3}} 
\index{rpath@{rpath}!readpathfromfile@{readpathfromfile}}
\index{readpathfromfile@{readpathfromfile}!rpath@{rpath}}
\subsubsection{\texorpdfstring{readpathfromfile()}{readpathfromfile()}}
{\footnotesize\ttfamily subroutine rpath\+::readpathfromfile (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{pathfile }\end{DoxyParamCaption})}



Read\+Path\+From\+File. 

Reads a file reaction path from a xyz file with nimage frames. First, we read the number of atoms and images, then create the path object. Finally, we read in the coordinates along the path.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item pathfile\+: filename for path. 
\end{DoxyItemize}

Definition at line 1655 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_afeb43b9e8aed2543261318d3585a0832}\label{namespacerpath_afeb43b9e8aed2543261318d3585a0832}} 
\index{rpath@{rpath}!setpathconstraints@{setpathconstraints}}
\index{setpathconstraints@{setpathconstraints}!rpath@{rpath}}
\subsubsection{\texorpdfstring{setpathconstraints()}{setpathconstraints()}}
{\footnotesize\ttfamily subroutine rpath\+::setpathconstraints (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{integer, intent(in)}]{N\+D\+O\+Fconstr,  }\item[{integer, dimension($\ast$), intent(in)}]{Fixed\+D\+OF,  }\item[{integer, intent(in)}]{Natomconstr,  }\item[{integer, dimension($\ast$), intent(in)}]{Fixedatom }\end{DoxyParamCaption})}



Set\+Path\+Constraints. 

Identify constrained atoms and D\+O\+Fs in the path.


\begin{DoxyItemize}
\item rp\+: Initialized path object.
\item N\+D\+O\+Fconstr\+: Number of D\+OF constraints.
\item Fixed\+D\+OF\+: Array containing integer number of constrained D\+O\+Fs
\item Natomconstr\+: Number of atom constraints
\item Fixedatom\+: Array containing integer ids of fixed atoms. 
\end{DoxyItemize}

Definition at line 1754 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ac8b51bb543056270fc034d75ba2a7266}\label{namespacerpath_ac8b51bb543056270fc034d75ba2a7266}} 
\index{rpath@{rpath}!getpathenergy@{getpathenergy}}
\index{getpathenergy@{getpathenergy}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getpathenergy()}{getpathenergy()}}
{\footnotesize\ttfamily subroutine rpath\+::getpathenergy (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{success }\end{DoxyParamCaption})}



Get\+Path\+Energy. 

Calculates the energy for all structures along a reaction path. The \mbox{\hyperlink{pes_8f90_source}{pes.\+f90}} module contains details of the calculation to perform.


\begin{DoxyItemize}
\item rp\+: Path object. 
\end{DoxyItemize}

Definition at line 1781 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a1faa43d82cebd49dbfb23e87189db2c2}\label{namespacerpath_a1faa43d82cebd49dbfb23e87189db2c2}} 
\index{rpath@{rpath}!getprojforces1@{getprojforces1}}
\index{getprojforces1@{getprojforces1}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getprojforces1()}{getprojforces1()}}
{\footnotesize\ttfamily subroutine rpath\+::getprojforces1 (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{kon,  }\item[{logical}]{ci\+\_\+flag,  }\item[{logical}]{endflag }\end{DoxyParamCaption})}



Get\+Proj\+Forces1. 

Calculates the forces projected along the reaction path, as required in N\+EB or C\+I\+N\+EB calculations. A previous P\+ES calculation M\+U\+ST have been performed for the reaction path.

Note\+: By setting ci\+\_\+flag = .true., this routine returns forces for C\+I-\/\+N\+EB.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item kon\+: Flag determining if the spring forces should be calculated or not
\item ci\+\_\+flag\+: Logical flag indicating whether to return climbing-\/image forces.
\item endflag\+: Logical flag indicatin whether or not the forces on the end-\/point beads should be returned as the \char`\"{}bare\char`\"{} (non-\/\+N\+EB) forces. 
\end{DoxyItemize}

Definition at line 1825 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ac95367fc9bf411eca8d31874d5e3e703}\label{namespacerpath_ac95367fc9bf411eca8d31874d5e3e703}} 
\index{rpath@{rpath}!getprojforces2@{getprojforces2}}
\index{getprojforces2@{getprojforces2}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getprojforces2()}{getprojforces2()}}
{\footnotesize\ttfamily subroutine rpath\+::getprojforces2 (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{kon,  }\item[{logical}]{ci\+\_\+flag,  }\item[{logical}]{endflag }\end{DoxyParamCaption})}



Get\+Proj\+Forces2. 

Calculates the forces projected along the reaction path, as required in N\+EB or C\+I\+N\+EB calculations. A previous P\+ES calculation M\+U\+ST have been performed for the reaction path. This routine uses a slightly improved version of tangents and forces as described by henkelman 00

Note\+: By setting ci\+\_\+flag = .true., this routine returns forces for C\+I-\/\+N\+EB.


\begin{DoxyItemize}
\item rp\+: Reaction path object. size is made.
\item ci\+\_\+flag\+: Logical flag indicating whether to return climbing-\/image forces.
\item endflag\+: Logical flag indicatin whether or not the forces on the end-\/point beads should be returned as the \char`\"{}bare\char`\"{} (non-\/\+N\+EB) forces. 
\end{DoxyItemize}

Definition at line 2205 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a79ee81833120305547c237a755918472}\label{namespacerpath_a79ee81833120305547c237a755918472}} 
\index{rpath@{rpath}!getprojforces3@{getprojforces3}}
\index{getprojforces3@{getprojforces3}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getprojforces3()}{getprojforces3()}}
{\footnotesize\ttfamily subroutine rpath\+::getprojforces3 (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{kon,  }\item[{logical}]{ci\+\_\+flag,  }\item[{logical}]{endflag }\end{DoxyParamCaption})}



Get\+Proj\+Forces3. 

Calculates the forces projected along the reaction path, as required in N\+EB or C\+I\+N\+EB calculations. This routine uses improves the improvement in henkelmans two 00 papers as described in Kolsbjerg and Hammer 16

Note\+: By setting ci\+\_\+flag = .true., this routine returns forces for C\+I-\/\+N\+EB.


\begin{DoxyItemize}
\item rp\+: Reaction path object. size is made.
\item ci\+\_\+flag\+: Logical flag indicating whether to return climbing-\/image forces.
\item endflag\+: Logical flag indicatin whether or not the forces on the end-\/point beads should be returned as the \char`\"{}bare\char`\"{} (non-\/\+N\+EB) forces. 
\end{DoxyItemize}

Definition at line 2361 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aae808f74fd2e658a175c79600c5bfe34}\label{namespacerpath_aae808f74fd2e658a175c79600c5bfe34}} 
\index{rpath@{rpath}!shimmyendbeads@{shimmyendbeads}}
\index{shimmyendbeads@{shimmyendbeads}!rpath@{rpath}}
\subsubsection{\texorpdfstring{shimmyendbeads()}{shimmyendbeads()}}
{\footnotesize\ttfamily subroutine rpath\+::shimmyendbeads (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{shimmied,  }\item[{integer}]{beadcount,  }\item[{integer}]{pend }\end{DoxyParamCaption})}



Shimmy\+End\+Beads. 


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item kspring\+: N\+EB spring constant (in au), used as a reference for variable spring size is made. 
\end{DoxyItemize}

Definition at line 2471 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ae42b5c49527891229d00dfab8a17bd90}\label{namespacerpath_ae42b5c49527891229d00dfab8a17bd90}} 
\index{rpath@{rpath}!loosenspringofflatmiddle@{loosenspringofflatmiddle}}
\index{loosenspringofflatmiddle@{loosenspringofflatmiddle}!rpath@{rpath}}
\subsubsection{\texorpdfstring{loosenspringofflatmiddle()}{loosenspringofflatmiddle()}}
{\footnotesize\ttfamily subroutine rpath\+::loosenspringofflatmiddle (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{loosened,  }\item[{integer}]{beadcount }\end{DoxyParamCaption})}



Loosen\+Spring\+Of\+Flat\+Middle (C\+U\+R\+R\+E\+N\+T\+LY N\+OT U\+S\+ED....D\+I\+D\+NT R\+E\+A\+L\+LY W\+O\+RK..) 

If there is a very flat plato in the middle of the reaction path it is indicative of something like A-\/H + B --$>$ A H B --$>$ A + H-\/B where the H atom has been flying through space, instead of being concerted where few beads are choosen, N\+EB tends to get \char`\"{}stuck\char`\"{}, instead of bringing either A-\/H or H-\/B closer together (as the minimum path of a concerted reaction should lie


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item loosened\+: wheather it has been applied or not
\item beadcount\+: how meany bead springs where loosened.. 
\end{DoxyItemize}

Definition at line 2596 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a17575cd0e216ffd99d188bb982fd2efc}\label{namespacerpath_a17575cd0e216ffd99d188bb982fd2efc}} 
\index{rpath@{rpath}!getfourierforces@{getfourierforces}}
\index{getfourierforces@{getfourierforces}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getfourierforces()}{getfourierforces()}}
{\footnotesize\ttfamily subroutine rpath\+::getfourierforces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Get\+Fourier\+Forces. 

Calculates the Fourier expansion coefficients for the path rp.


\begin{DoxyItemize}
\item rp\+: Input reaction-\/path object. 
\end{DoxyItemize}

Definition at line 2649 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a8808a2a9ef2cd749de76ec66e662cf4c}\label{namespacerpath_a8808a2a9ef2cd749de76ec66e662cf4c}} 
\index{rpath@{rpath}!fouriertopath@{fouriertopath}}
\index{fouriertopath@{fouriertopath}!rpath@{rpath}}
\subsubsection{\texorpdfstring{fouriertopath()}{fouriertopath()}}
{\footnotesize\ttfamily subroutine rpath\+::fouriertopath (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Fourier\+To\+Path. 

Calculates the path positions using the path Fourier coefficients.


\begin{DoxyItemize}
\item rp\+: Input reaction-\/path object. 
\end{DoxyItemize}

Definition at line 2714 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a58f6e30e1af43edf4aa86279c520213f}\label{namespacerpath_a58f6e30e1af43edf4aa86279c520213f}} 
\index{rpath@{rpath}!pathtofourier@{pathtofourier}}
\index{pathtofourier@{pathtofourier}!rpath@{rpath}}
\subsubsection{\texorpdfstring{pathtofourier()}{pathtofourier()}}
{\footnotesize\ttfamily subroutine rpath\+::pathtofourier (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp }\end{DoxyParamCaption})}



Path\+To\+Fourier. 

Calculates the Fourier coefficiencts from path positions.


\begin{DoxyItemize}
\item rp\+: Input reaction-\/path object. 
\end{DoxyItemize}

Definition at line 2761 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aa76074b978980fcf3419586f037a4385}\label{namespacerpath_aa76074b978980fcf3419586f037a4385}} 
\index{rpath@{rpath}!getcoeffmomenta@{getcoeffmomenta}}
\index{getcoeffmomenta@{getcoeffmomenta}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getcoeffmomenta()}{getcoeffmomenta()}}
{\footnotesize\ttfamily subroutine rpath\+::getcoeffmomenta (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{temperature,  }\item[{real(8)}]{mass,  }\item[{integer}]{irun }\end{DoxyParamCaption})}



Get\+Coeff\+Momenta. 

Samples the path Fourier coefficient momenta from the Boltzmann distribution.


\begin{DoxyItemize}
\item rp\+: Input reaction-\/path object.
\item temperature\+: Input sampling temperature.
\item mass\+: Assumed mass for Fourier coefficients.
\item irun\+: Random number seed. 
\end{DoxyItemize}

Definition at line 2806 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a7fee98f4bae0eeddfeb9c7a7a0cd36de}\label{namespacerpath_a7fee98f4bae0eeddfeb9c7a7a0cd36de}} 
\index{rpath@{rpath}!firstvvupdate@{firstvvupdate}}
\index{firstvvupdate@{firstvvupdate}!rpath@{rpath}}
\subsubsection{\texorpdfstring{firstvvupdate()}{firstvvupdate()}}
{\footnotesize\ttfamily subroutine rpath\+::firstvvupdate (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{timestep,  }\item[{real(8)}]{mass }\end{DoxyParamCaption})}



First\+V\+V\+Update. 

Evolves the Fourier coefficients and momenta through first half of a Velocity-\/\+Verlet time-\/step.


\begin{DoxyItemize}
\item rp\+: Reaction path object
\item timestep\+: obvs...
\item mass\+: Fourier coefficient mass. 
\end{DoxyItemize}

Definition at line 2842 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ac85f7c72e6a51be0d86bde43398f5d1b}\label{namespacerpath_ac85f7c72e6a51be0d86bde43398f5d1b}} 
\index{rpath@{rpath}!secondvvupdate@{secondvvupdate}}
\index{secondvvupdate@{secondvvupdate}!rpath@{rpath}}
\subsubsection{\texorpdfstring{secondvvupdate()}{secondvvupdate()}}
{\footnotesize\ttfamily subroutine rpath\+::secondvvupdate (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{timestep,  }\item[{real(8)}]{mass }\end{DoxyParamCaption})}



Second\+V\+V\+Update. 

Evolves the Fourier coefficients and momenta through second half of a Velocity-\/\+Verlet time-\/step.


\begin{DoxyItemize}
\item rp\+: Reaction path object
\item timestep\+: obvs...
\item mass\+: Fourier coefficient mass. 
\end{DoxyItemize}

Definition at line 2908 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ae05b8e955144357569094f22cb55b245}\label{namespacerpath_ae05b8e955144357569094f22cb55b245}} 
\index{rpath@{rpath}!getspringforces@{getspringforces}}
\index{getspringforces@{getspringforces}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getspringforces()}{getspringforces()}}
{\footnotesize\ttfamily subroutine rpath\+::getspringforces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{kspring }\end{DoxyParamCaption})}



Get\+Spring\+Forces. 

Calculates the inter-\/bead spring potential and forces.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item kspring\+: Spring constant 
\end{DoxyItemize}

Definition at line 2968 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a89297ca90bf4171b4d1ac5a941e80a50}\label{namespacerpath_a89297ca90bf4171b4d1ac5a941e80a50}} 
\index{rpath@{rpath}!removepathcollisions@{removepathcollisions}}
\index{removepathcollisions@{removepathcollisions}!rpath@{rpath}}
\subsubsection{\texorpdfstring{removepathcollisions()}{removepathcollisions()}}
{\footnotesize\ttfamily subroutine rpath\+::removepathcollisions (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{integer}]{ngdsrelax,  }\item[{real(8)}]{gdsdtrelax,  }\item[{real(8)}]{nbstrength,  }\item[{real(8)}]{gdsrestspring,  }\item[{real(8)}]{nbrange }\end{DoxyParamCaption})}



Remove\+Collisions. 

Refinement of path to ensure no collisions.


\begin{DoxyItemize}
\item rp\+: Reaction path object. 
\end{DoxyItemize}

Definition at line 3006 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a75785c13dc36360c86c2ef8e8dd11fad}\label{namespacerpath_a75785c13dc36360c86c2ef8e8dd11fad}} 
\index{rpath@{rpath}!minimisecollision@{minimisecollision}}
\index{minimisecollision@{minimisecollision}!rpath@{rpath}}
\subsubsection{\texorpdfstring{minimisecollision()}{minimisecollision()}}
{\footnotesize\ttfamily subroutine rpath\+::minimisecollision (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{integer}]{ngdsrelax,  }\item[{real(8)}]{gdsdtrelax,  }\item[{real(8)}]{nbstrength,  }\item[{real(8)}]{gdsrestspring,  }\item[{real(8)}]{nbrange,  }\item[{real(8), dimension(na,na)}]{rmin,  }\item[{real(8), dimension(na,na)}]{rmax,  }\item[{integer}]{na,  }\item[{integer}]{im1,  }\item[{integer}]{im2 }\end{DoxyParamCaption})}



Minimise\+Collision. 

Minimization of path to ensure no collisions


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item rmin,rmax\+: minuiimum and maximum distance matrices between atoms where the G\+RP is switched on, i think...
\item im1, im2\+: the range of images that we want this applied to 
\end{DoxyItemize}

Definition at line 3103 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aa844bacf78aac643d982ebb18988dbb6}\label{namespacerpath_aa844bacf78aac643d982ebb18988dbb6}} 
\index{rpath@{rpath}!stripinactivefrompath@{stripinactivefrompath}}
\index{stripinactivefrompath@{stripinactivefrompath}!rpath@{rpath}}
\subsubsection{\texorpdfstring{stripinactivefrompath()}{stripinactivefrompath()}}
{\footnotesize\ttfamily subroutine rpath\+::stripinactivefrompath (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character$\ast$($\ast$)}]{stripfile,  }\item[{integer, dimension(3$\ast$namax)}]{Fixed\+D\+OF,  }\item[{integer, dimension(namax)}]{Fixed\+Atom,  }\item[{integer}]{N\+D\+O\+Fconstr,  }\item[{integer}]{Natomconstr }\end{DoxyParamCaption})}



Strip\+Inactive\+From\+Path. 

Removes inactive molecules from the reaction path. Here, inactive means that the molecules are not involved in any bond changes.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item stripfile\+: The filename where the stripped path is output. 
\end{DoxyItemize}

Definition at line 3197 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a4c7410e4e6417ef235293315107537e8}\label{namespacerpath_a4c7410e4e6417ef235293315107537e8}} 
\index{rpath@{rpath}!errorr@{errorr}}
\index{errorr@{errorr}!rpath@{rpath}}
\subsubsection{\texorpdfstring{errorr()}{errorr()}}
{\footnotesize\ttfamily real(8) function rpath\+::errorr (\begin{DoxyParamCaption}\item[{real(8), dimension(3,na)}]{one,  }\item[{real(8), dimension(3,na)}]{two,  }\item[{integer}]{na }\end{DoxyParamCaption})}



errorr calculates the absolute difference, elementwise between two matrices. 


\begin{DoxyItemize}
\item one, two\+: the matrices
\item na\+: ... 
\end{DoxyItemize}

Definition at line 3380 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a37439f39e5934c023cbc1ce46a641de9}\label{namespacerpath_a37439f39e5934c023cbc1ce46a641de9}} 
\index{rpath@{rpath}!geteulermatrices@{geteulermatrices}}
\index{geteulermatrices@{geteulermatrices}!rpath@{rpath}}
\subsubsection{\texorpdfstring{geteulermatrices()}{geteulermatrices()}}
{\footnotesize\ttfamily subroutine rpath\+::geteulermatrices (\begin{DoxyParamCaption}\item[{real(8), dimension(3,3)}]{lh,  }\item[{real(8)}]{phi,  }\item[{real(8)}]{theta,  }\item[{real(8)}]{psi }\end{DoxyParamCaption})}



Get\+Euler\+Matrices. 

Returns a rotation matrix given by the euler angles phi, theta and psi...


\begin{DoxyItemize}
\item lh\+: the matrix
\item theta, phi, psi\+: the angles 
\end{DoxyItemize}

Definition at line 3403 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a57a80823cabeccdde83680731d65d88e}\label{namespacerpath_a57a80823cabeccdde83680731d65d88e}} 
\index{rpath@{rpath}!getidpppathweightsdis@{getidpppathweightsdis}}
\index{getidpppathweightsdis@{getidpppathweightsdis}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getidpppathweightsdis()}{getidpppathweightsdis()}}
{\footnotesize\ttfamily subroutine rpath\+::getidpppathweightsdis (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{double precision, dimension(\+:,\+:), allocatable}]{adpp,  }\item[{real(8)}]{H\+I\+D\+PP }\end{DoxyParamCaption})}



Get\+I\+D\+P\+P\+Path\+Weights\+Dis. 

The matrix of exponential parameters in the repulsive exponential function for atoms that are too close to each other dufing the I\+D\+PP path optimization.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item adpp\+: the exponential parameters in matrix form 
\end{DoxyItemize}

Definition at line 3437 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a40c08338c270399cecf65a4f2e6b858d}\label{namespacerpath_a40c08338c270399cecf65a4f2e6b858d}} 
\index{rpath@{rpath}!getidppinterpdistance@{getidppinterpdistance}}
\index{getidppinterpdistance@{getidppinterpdistance}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getidppinterpdistance()}{getidppinterpdistance()}}
{\footnotesize\ttfamily subroutine rpath\+::getidppinterpdistance (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{double precision, dimension(\+:,\+:,\+:), allocatable}]{ids }\end{DoxyParamCaption})}



Get\+I\+D\+P\+P\+Interp\+Distance. 

Gets the distance between atoms interpolated at every image (from the beggining and end)\+: see smidstrup and jonsson 2014 chemphys


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item ids\+: interpolated distance matrix, per image 
\end{DoxyItemize}

Definition at line 3475 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a65a712550505b1542b4f01af95a18c1a}\label{namespacerpath_a65a712550505b1542b4f01af95a18c1a}} 
\index{rpath@{rpath}!getidppforces@{getidppforces}}
\index{getidppforces@{getidppforces}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getidppforces()}{getidppforces()}}
{\footnotesize\ttfamily subroutine rpath\+::getidppforces (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{double precision, dimension(rp\%na,rp\%na)}]{adpp,  }\item[{double precision, dimension(rp\%nimage,rp\%na,rp\%na)}]{ids,  }\item[{real(8)}]{H\+I\+D\+PP }\end{DoxyParamCaption})}



Get\+I\+D\+P\+P\+Forces. 

Calculates the I\+D\+PP forces used for the I\+D\+PP optimised path. see smidstrup and jonsson 2014 chemphys


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item dppw\+: the weights in matrix form (slightly redundant but cheaper computationally) 
\end{DoxyItemize}

Definition at line 3510 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a4749f3881a10626d54544110e0eb1cba}\label{namespacerpath_a4749f3881a10626d54544110e0eb1cba}} 
\index{rpath@{rpath}!geninterpol@{geninterpol}}
\index{geninterpol@{geninterpol}!rpath@{rpath}}
\subsubsection{\texorpdfstring{geninterpol()}{geninterpol()}}
{\footnotesize\ttfamily subroutine rpath\+::geninterpol (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{idpppath,  }\item[{real(8)}]{rad\+\_\+min,  }\item[{logical}]{callgather }\end{DoxyParamCaption})}



Gen\+Interpol. 

for reaction paths which involve several molecules exchanging fragments, we linearly interpolate one third of the images of both ends such that the molecules are gathered around a reaction centre in space. the remaining third of images are then used to interpolate either linearly or using I\+D\+P\+P-\/\+N\+EB, to describe the exchange of fragments up close. This routine is mostly a copy of Gather\+Reactive\+Nolecules with some extra interpolattion steps added to it


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item ipppath\+: weather or not to use image dependent pair potential interpolation of the close images
\item rad\+\_\+min\+: distance between the molecules GC when they are close 
\end{DoxyItemize}

Definition at line 3577 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a2e9f77deb07ac9c56b2068eaf7853a4a}\label{namespacerpath_a2e9f77deb07ac9c56b2068eaf7853a4a}} 
\index{rpath@{rpath}!optimisereactivemolecules@{optimisereactivemolecules}}
\index{optimisereactivemolecules@{optimisereactivemolecules}!rpath@{rpath}}
\subsubsection{\texorpdfstring{optimisereactivemolecules()}{optimisereactivemolecules()}}
{\footnotesize\ttfamily subroutine rpath\+::optimisereactivemolecules (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{logical}]{success,  }\item[{integer}]{itmp,  }\item[{integer}]{imove }\end{DoxyParamCaption})}



Optimise\+Reactive\+Molecules. 

Takes every molecule involved in the reaction and performs an optimization on them, First including the graph contraining potential, if the user specified nebrestrend = .true., followed by a pure optimization. the molecules are then placed back in the soup, centered on the centre of mass of the old, unoptimised starting structure, and rotated to maximise overlap with it.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item stripfile\+: The filename where the stripped path is output. 
\end{DoxyItemize}

Definition at line 3876 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_aafdcf74818568a7573511f5205a558e0}\label{namespacerpath_aafdcf74818568a7573511f5205a558e0}} 
\index{rpath@{rpath}!moleculevalid@{moleculevalid}}
\index{moleculevalid@{moleculevalid}!rpath@{rpath}}
\subsubsection{\texorpdfstring{moleculevalid()}{moleculevalid()}}
{\footnotesize\ttfamily logical function rpath\+::moleculevalid (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer, dimension(cx\%na,cx\%na)}]{ograph }\end{DoxyParamCaption})}



Molecule\+Valid. 

Does all the checks on the S\+I\+N\+G\+LE molecule strucuture cx.


\begin{DoxyItemize}
\item cx\+: the reaction structure
\item ograph\+: the original graph before the optimization 
\end{DoxyItemize}

Definition at line 4146 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a1af24f3421dc3b87b062668f04eaee22}\label{namespacerpath_a1af24f3421dc3b87b062668f04eaee22}} 
\index{rpath@{rpath}!printmolecularenergies@{printmolecularenergies}}
\index{printmolecularenergies@{printmolecularenergies}!rpath@{rpath}}
\subsubsection{\texorpdfstring{printmolecularenergies()}{printmolecularenergies()}}
{\footnotesize\ttfamily subroutine rpath\+::printmolecularenergies (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{filename }\end{DoxyParamCaption})}



Print\+Molecular\+Energies. 

prints into filename the energies of each molecule in the reactants and produts of rp


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item filenam\+: The filename to be outputed 
\end{DoxyItemize}

Definition at line 4234 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ab03d1a925ddda8a471cc0faf8bc393c6}\label{namespacerpath_ab03d1a925ddda8a471cc0faf8bc393c6}} 
\index{rpath@{rpath}!getactmolecenergies@{getactmolecenergies}}
\index{getactmolecenergies@{getactmolecenergies}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getactmolecenergies()}{getactmolecenergies()}}
{\footnotesize\ttfamily subroutine rpath\+::getactmolecenergies (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer, dimension(nactmol)}]{Molec\+Act,  }\item[{integer}]{nactmol,  }\item[{double precision, dimension(nactmol)}]{molen }\end{DoxyParamCaption})}



Get\+Act\+Molecular\+Energies. 

Get the energies of each molecule in the reactants and produts of rp


\begin{DoxyItemize}
\item cx\+: chemical structure.
\item Molec\+Act\+: array with the molecue indecies
\item nactmol\+: number of molecules in Molec\+Act array
\item molen\+: array with energies
\item filenam\+: The filename to be outputed 
\end{DoxyItemize}

Definition at line 4326 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a9499e691ae9b7d354e0c84bb147b41ab}\label{namespacerpath_a9499e691ae9b7d354e0c84bb147b41ab}} 
\index{rpath@{rpath}!gatherreactivemolecules@{gatherreactivemolecules}}
\index{gatherreactivemolecules@{gatherreactivemolecules}!rpath@{rpath}}
\subsubsection{\texorpdfstring{gatherreactivemolecules()}{gatherreactivemolecules()}}
{\footnotesize\ttfamily subroutine rpath\+::gatherreactivemolecules (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{rad\+\_\+min }\end{DoxyParamCaption})}



Gather\+Reactive\+Nolecules. 

It moves all reactive moleucles around a common centre in space so that they are as close as possible to each other to exchange the appropriate atoms.


\begin{DoxyItemize}
\item rp\+: The reaction path object. 
\end{DoxyItemize}

Definition at line 4356 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a259f0a538ae15f09680183f2a259da58}\label{namespacerpath_a259f0a538ae15f09680183f2a259da58}} 
\index{rpath@{rpath}!addtomoleculardatabase@{addtomoleculardatabase}}
\index{addtomoleculardatabase@{addtomoleculardatabase}!rpath@{rpath}}
\subsubsection{\texorpdfstring{addtomoleculardatabase()}{addtomoleculardatabase()}}
{\footnotesize\ttfamily subroutine rpath\+::addtomoleculardatabase (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{type(\mbox{\hyperlink{structrpath_1_1fingerprint}{fingerprint}})}]{fngr,  }\item[{type(\mbox{\hyperlink{structglobaldata_1_1moldata}{moldata}})}]{Md,  }\item[{integer}]{itot }\end{DoxyParamCaption})}



Add\+To\+Molecular\+Database. 

adds molecular structure mol, and reaction to the Mol\+Data dtatype of the new molecules and reaction generated

rp -\/ reaction path fngr -\/ fingerprint of the current MolD -\/ molecular database 

Definition at line 4579 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a8d4afda6b550a4857b9800f7d94cb87b}\label{namespacerpath_a8d4afda6b550a4857b9800f7d94cb87b}} 
\index{rpath@{rpath}!savemoleculardatabase@{savemoleculardatabase}}
\index{savemoleculardatabase@{savemoleculardatabase}!rpath@{rpath}}
\subsubsection{\texorpdfstring{savemoleculardatabase()}{savemoleculardatabase()}}
{\footnotesize\ttfamily subroutine rpath\+::savemoleculardatabase (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structglobaldata_1_1moldata}{moldata}})}]{Md,  }\item[{character, dimension($\ast$)}]{filename }\end{DoxyParamCaption})}



Save\+Molecular\+Database. 

Saves the molecular database in a binary file \char`\"{}filename\char`\"{}\+\_\+\+Mol.\+bin

MolD -\/ molecular database filename -\/ filename 

Definition at line 4733 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a296f9413787464666a45c1433ea90a32}\label{namespacerpath_a296f9413787464666a45c1433ea90a32}} 
\index{rpath@{rpath}!readmoleculardatabase@{readmoleculardatabase}}
\index{readmoleculardatabase@{readmoleculardatabase}!rpath@{rpath}}
\subsubsection{\texorpdfstring{readmoleculardatabase()}{readmoleculardatabase()}}
{\footnotesize\ttfamily subroutine rpath\+::readmoleculardatabase (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structglobaldata_1_1moldata}{moldata}})}]{Md,  }\item[{character, dimension($\ast$)}]{filename }\end{DoxyParamCaption})}



Read\+Molecular\+Database. 

Reads in the molecular database from a binary file \char`\"{}filename\char`\"{}\+\_\+\+Mol.\+bin

MolD -\/ molecular database filename -\/ filename 

Definition at line 4776 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_a1163d0179108c7da7f7b0590d9a5b911}\label{namespacerpath_a1163d0179108c7da7f7b0590d9a5b911}} 
\index{rpath@{rpath}!printmoleculardatabase@{printmoleculardatabase}}
\index{printmoleculardatabase@{printmoleculardatabase}!rpath@{rpath}}
\subsubsection{\texorpdfstring{printmoleculardatabase()}{printmoleculardatabase()}}
{\footnotesize\ttfamily subroutine rpath\+::printmoleculardatabase (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structglobaldata_1_1moldata}{moldata}})}]{Md,  }\item[{character, dimension($\ast$)}]{filename }\end{DoxyParamCaption})}



Print\+Molecular\+Database. 

Prints the molecular database in a human readable format file \char`\"{}filename\char`\"{}\+\_\+\+Mol.\+bin

MolD -\/ molecular database filename -\/ filename 

Definition at line 4830 of file rpath.\+f90.

\mbox{\Hypertarget{namespacerpath_ad5763afa90216356bb2694841d938592}\label{namespacerpath_ad5763afa90216356bb2694841d938592}} 
\index{rpath@{rpath}!molecularformula@{molecularformula}}
\index{molecularformula@{molecularformula}!rpath@{rpath}}
\subsubsection{\texorpdfstring{molecularformula()}{molecularformula()}}
{\footnotesize\ttfamily character(\+:) function, allocatable rpath\+::molecularformula (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structchemstr_1_1cxs}{cxs}})}]{cx,  }\item[{integer}]{molid }\end{DoxyParamCaption})}



Molecular\+Formula. 

Returns a variable length string with the molecular formula of molecule molid, from chemical structure cx.


\begin{DoxyItemize}
\item cx\+: chemical structure
\item molecule index 
\end{DoxyItemize}

Definition at line 347 of file rpath\+\_\+\+B\+A\+C\+K\+U\+P\+\_\+68612.\+f90.

\mbox{\Hypertarget{namespacerpath_a3ea5ea388547f210105034dd8fdab394}\label{namespacerpath_a3ea5ea388547f210105034dd8fdab394}} 
\index{rpath@{rpath}!printpathchemreactofile@{printpathchemreactofile}}
\index{printpathchemreactofile@{printpathchemreactofile}!rpath@{rpath}}
\subsubsection{\texorpdfstring{printpathchemreactofile()}{printpathchemreactofile()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily subroutine rpath\+::printpathchemreactofile (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{character, dimension($\ast$)}]{filename,  }\item[{integer}]{path\+\_\+id,  }\item[{integer}]{imove,  }\item[{integer}]{ic }\end{DoxyParamCaption})}



Print\+Path\+To\+File. 

Outputs the chemical reaction onto filename providede with path\+\_\+id provdided


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item filename\+: the output xyz file.
\item path\+\_\+id\+: the id of the reaction path provided 
\end{DoxyItemize}

Definition at line 780 of file rpath\+\_\+\+B\+A\+C\+K\+U\+P\+\_\+68612.\+f90.

\mbox{\Hypertarget{namespacerpath_ab5e5d395f73dd82e69efa6977b748dc9}\label{namespacerpath_ab5e5d395f73dd82e69efa6977b748dc9}} 
\index{rpath@{rpath}!getpathfingerprints@{getpathfingerprints}}
\index{getpathfingerprints@{getpathfingerprints}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getpathfingerprints()}{getpathfingerprints()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily subroutine rpath\+::getpathfingerprints (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{integer}]{imove,  }\item[{integer}]{ic,  }\item[{type(\mbox{\hyperlink{structrpath_1_1fingerprint}{fingerprint}})}]{fngr }\end{DoxyParamCaption})}



Get\+Path\+Finger\+Prints. 

returns a fingerprint derived type (see top \mbox{\hyperlink{rpath_8f90_source}{rpath.\+f90}}) with the \char`\"{}fingerprints\char`\"{} of the reaction path provided


\begin{DoxyItemize}
\item rp\+: The reaction path object.
\item imove\+: the graph move performed by this rp
\item ic\+: which end of the path underwent this move 
\end{DoxyItemize}

Definition at line 878 of file rpath\+\_\+\+B\+A\+C\+K\+U\+P\+\_\+68612.\+f90.

\mbox{\Hypertarget{namespacerpath_a94586723a045fa2d44e3f6b6a91d1d50}\label{namespacerpath_a94586723a045fa2d44e3f6b6a91d1d50}} 
\index{rpath@{rpath}!getprojectedforces@{getprojectedforces}}
\index{getprojectedforces@{getprojectedforces}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getprojectedforces()}{getprojectedforces()}}
{\footnotesize\ttfamily subroutine rpath\+::getprojectedforces (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{real(8)}]{kspring,  }\item[{logical}]{ci\+\_\+flag,  }\item[{logical}]{endflag,  }\item[{logical}]{variablespring }\end{DoxyParamCaption})}



Get\+Projected\+Forces. 

Calculates the forces projected along the reaction path, as required in N\+EB or C\+I\+N\+EB calculations. A previous P\+ES calculation M\+U\+ST have been performed for the reaction path.

Note\+: By setting ci\+\_\+flag = .true., this routine returns forces for C\+I-\/\+N\+EB.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item kspring\+: N\+EB spring constant (in au).
\item ci\+\_\+flag\+: Logical flag indicating whether to return climbing-\/image forces.
\item endflag\+: Logical flag indicatin whether or not the forces on the end-\/point beads should be returned as the \char`\"{}bare\char`\"{} (non-\/\+N\+EB) forces. 
\end{DoxyItemize}

Definition at line 1594 of file rpath\+\_\+\+B\+A\+C\+K\+U\+P\+\_\+68612.\+f90.

\mbox{\Hypertarget{namespacerpath_a77818427a2d3efbe627d872dd929e11e}\label{namespacerpath_a77818427a2d3efbe627d872dd929e11e}} 
\index{rpath@{rpath}!getprojforces@{getprojforces}}
\index{getprojforces@{getprojforces}!rpath@{rpath}}
\subsubsection{\texorpdfstring{getprojforces()}{getprojforces()}}
{\footnotesize\ttfamily subroutine rpath\+::getprojforces (\begin{DoxyParamCaption}\item[{type (\mbox{\hyperlink{structrpath_1_1rxp}{rxp}})}]{rp,  }\item[{double precision}]{kspring,  }\item[{logical}]{ci\+\_\+flag,  }\item[{logical}]{endflag,  }\item[{logical}]{variablespring }\end{DoxyParamCaption})}



Get\+Proj\+Forces. 

Calculates the forces projected along the reaction path, as required in N\+EB or C\+I\+N\+EB calculations. A previous P\+ES calculation M\+U\+ST have been performed for the reaction path. This routine uses a slightly improved version of tangents and forces as described by henkelman 00 as well as a viariable spring strength as described in the other henkelman 00 paper

Note\+: By setting ci\+\_\+flag = .true., this routine returns forces for C\+I-\/\+N\+EB.


\begin{DoxyItemize}
\item rp\+: Reaction path object.
\item kspring\+: N\+EB spring constant (in au), used as a reference for variable spring size is made.
\item ci\+\_\+flag\+: Logical flag indicating whether to return climbing-\/image forces.
\item endflag\+: Logical flag indicatin whether or not the forces on the end-\/point beads should be returned as the \char`\"{}bare\char`\"{} (non-\/\+N\+EB) forces.
\item variablespring\+: flag determining if we should make the spring strength variable or not 
\end{DoxyItemize}

Definition at line 2003 of file rpath\+\_\+\+B\+A\+C\+K\+U\+P\+\_\+68612.\+f90.

