<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CDE: mcs Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CDE
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Chemistry Discovery Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemcs.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mcs Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Maximum Common Induced Subgraph between two Graphs Algorithm.  
<a href="namespacemcs.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a31acee50c123fd6604195c6dfc4f8afa"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemcs.html#a31acee50c123fd6604195c6dfc4f8afa">getmcs</a> (graph1, graph2, label1, label2, na1, na2, similarity, layers, fmap, fna, weight1, weight2)</td></tr>
<tr class="memdesc:a31acee50c123fd6604195c6dfc4f8afa"><td class="mdescLeft">&#160;</td><td class="mdescRight">GetMCS.  <a href="namespacemcs.html#a31acee50c123fd6604195c6dfc4f8afa">More...</a><br /></td></tr>
<tr class="separator:a31acee50c123fd6604195c6dfc4f8afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb955c085800bcc2c7123a65817828d2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemcs.html#abb955c085800bcc2c7123a65817828d2">getsubgraphs</a> (graph, label, na, subg, subnv, nsub)</td></tr>
<tr class="memdesc:abb955c085800bcc2c7123a65817828d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">GetSubGraphs.  <a href="namespacemcs.html#abb955c085800bcc2c7123a65817828d2">More...</a><br /></td></tr>
<tr class="separator:abb955c085800bcc2c7123a65817828d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Maximum Common Induced Subgraph between two Graphs Algorithm. </p>
<p>Calculates the Maximum Common Induced Subgraph between two Graphs, and returns these MCS fragments and gives an estimate of their similarity. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a31acee50c123fd6604195c6dfc4f8afa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31acee50c123fd6604195c6dfc4f8afa">&#9670;&nbsp;</a></span>getmcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mcs::getmcs </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(na1,na1), intent(in)&#160;</td>
          <td class="paramname"><em>graph1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(na2,na2), intent(in)&#160;</td>
          <td class="paramname"><em>graph2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=2), dimension(na1), intent(in)&#160;</td>
          <td class="paramname"><em>label1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=2), dimension(na2), intent(in)&#160;</td>
          <td class="paramname"><em>label2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>na1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>na2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>similarity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:,:), intent(out), optional, allocatable&#160;</td>
          <td class="paramname"><em>fmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out), optional, allocatable&#160;</td>
          <td class="paramname"><em>fna</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(na1), intent(out), optional&#160;</td>
          <td class="paramname"><em>weight1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(na2), intent(out), optional&#160;</td>
          <td class="paramname"><em>weight2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GetMCS. </p>
<p>Calculates the similarity of two graphs (graph1 and graph2, label1, label2, na1, na2) by using the Johnson measure (1985 wiley) which involves calculating every possible Maximum common subgraphs (MCS) between these graphs. The MCS algorithm used here is the MCSplit algorithm by McCreesh Prosser and Trimble (IJCAI 2017) the similarity is ( |V(G12)|+|E(G12)| )^2 / {( |V(G1)|+|E(G1)| ) ( |V(G2)|+|E(G2)| ) }. WARNING: this algorithm seems to work perfectly when given single-molecules. If we give a soup of molecules, and these molecules match perfectly, then sometimes the output "fragments" are one or two molecules together. Nevertheless the similarity measures are the same and the MCS fragments are correct... If we want the similarity between only atoms that are the maximum intersection of atoms between the graphs then it is given by similarity(1) ( V(G1) intersection V(G2) ), if we wish to include all vertices (atoms), such that the denominator includes all, then its given by similarity(2). So if G1 fits exactly on G2 but G2 is a much greater graph (G1 subset of G2) then similarity(1) will be 1 but not similarity(2) Optional arguments: if fmap,fna are provided, the programs returns arrays fna(layers) fmap(layers,2,max(fna)), the latter being a list of atomic indecies for each fragment (first index 1:layers) of each graph (1:2 first graph1, second graph2), with fna the array specifiying how many atoms in each fragment. if weight1 or weight2 are provided, a double precision weighting on each atom are specified. The arrays must be of length na1/na2</p>
<ul>
<li>layers (INOUT): when coming in it tells the program a maximum of how many fragments its supposed to calculate the similarity for (if layer = 1 then it returns a similarity for only the single MCS in common). If layers = 0 all fragments are returned, regardles off their size (can be lone atoms) if layers =-i all fragments greater than abs(i) are used to calculate similarity. On return, if layers was &lt;= 0 on the way out it returns how many fragments it actually found.</li>
<li>na1/na2 (IN): number of atoms in each graph</li>
<li>graph1/graph2 (IN): graphs compared</li>
<li>label1/label2 (IN): labels of graphs (eg 'C' 'H' etc...)</li>
<li>weight1/weight2 (IN): weighting for each atoms contriobuition to the similarity measure</li>
<li>similarity(2): (OUT): similarity measure of MCS fragments using (1) intersection of atoms in G1/G2 or (2) union of atoms in G1/G2</li>
<li>fna (OUT): arrays containing the number of atoms in each fragment found.</li>
<li>fmap (OUT): fmap(layers,2,max(fna)) for each fragment (1:layers) of each graph (1:2) the list of atomic indecies</li>
<li>G/H: graph types with the graphs from 1 and 2 respectively</li>
<li>M: mapping type, used to keep track of the current search tree history during the Search Routine</li>
<li>inc: incumbent mapping, keeps track of the current MCS found during Search</li>
<li>f/fl: labels types that store the availabel vertices to pick at different recursive stages during Search</li>
<li>mcsfrag: list of fragments between graphs </li>
</ul>

<p class="definition">Definition at line <a class="el" href="mcs_8f90_source.html#l00133">133</a> of file <a class="el" href="mcs_8f90_source.html">mcs.f90</a>.</p>

</div>
</div>
<a id="abb955c085800bcc2c7123a65817828d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb955c085800bcc2c7123a65817828d2">&#9670;&nbsp;</a></span>getsubgraphs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mcs::getsubgraphs </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(na,na), intent(in)&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=2), dimension(na), intent(in)&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>subg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>subnv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nsub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GetSubGraphs. </p>
<p>Calculates all the disconected subgraphs from the graph provided. Returns nsub (nmol) subnv (namol) and subg(molid)</p>
<ul>
<li>na (IN): number of atoms in graph</li>
<li>graph (IN): graph for whihc we calculate subgraphs</li>
<li>label (IN): labels of graphs (eg 'C' 'H' etc...)</li>
<li>nsub (OUT: number of disconnected graphs</li>
<li>subnv (OUT): arrays containing the number of atoms in each fragment(subgraph) found.</li>
<li>fmap (OUT): fmap(layers,2,max(fna)) for each fragment (1:layers) of each graph (1:2) the list of atomic indecies</li>
<li>G: graph types for graph</li>
<li>M: list of vertices <br  />
</li>
<li>frags: list of fragments (subgrpahs) found </li>
</ul>

<p class="definition">Definition at line <a class="el" href="mcs_8f90_source.html#l00290">290</a> of file <a class="el" href="mcs_8f90_source.html">mcs.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemcs.html">mcs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
