<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Tutorial 1: CINEB</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../test.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/df2/_tutorial1.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tutorial 1: CINEB </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section gives example input files and instructions for a typical CINEB calculation run through CDE.</p>
<p>In this case, we are going to run a CINEB optimization of a reaction path representing dissociation of molecular hydrogen (H2) from formaldehyde (H2CO). We will using the semi-empirical PM3 method <em>via</em> the <em>ab initio</em> code <em>ORCA</em>, to calculate potential energies and forces.</p>
<p><b>The actual files to run this example can be found in the *~/cde/examples/Tutorial_1 directory.</b></p>
<p>In this directory, you will find several input files: </p><pre class="fragment">  input
  initial_path.xyz
  orca.head
  orca.min
</pre><p>All of these input filenames are arbitrary; we could have called them alice, bob, clive and ralph and the program would still read them in correctly. Note that the extensions have no effect for input files read in by CDE, but they can be used to remind you what the different input files are.</p>
<p>Let's have a look at each input file individually:</p>
<h2><a class="anchor" id="autotoc_md24"></a>
input</h2>
<p>The <em>input</em> file looks like this: </p><pre class="fragment"># This input file demonstrates a CINEB refinement.
# We use the quickmin method here, and orca
# for PES calculations.

nimage 8
temperature 10
calctype optpath
startfile start.xyz
endfile end.xyz
pathfile path.xyz
ranseed  5
startfrompath  .FALSE.
pathinit  linear

# path optimization

pathoptmethod cineb
nebmethod quickmin
nebiter 250
vsthresh 1d-2
cithresh 1d-3
nebspring 0.05
nebconv 2d-3
nebstep  10.0
neboutfreq 5
stripinactive .FALSE.
optendsbefore .TRUE.
optendsduring .false.
nebrestrend .FALSE.
alignedatoms
1 2 3

# constraints

dofconstraints 0
atomconstraints 0

# PES input

pesfull .true.
pestype  orca
pesfile   orca.head
pesopttype  orca
pesoptfile orca.min
pesexecutable orca
pesoptexecutable orca
</pre><p>The input file in this case only contains those options which are relevant to the CINEB simulation; other input directives have been removed and will be ignored internally in CDE.</p>
<p>The first input block (beginning with the comment line "# control parameters") identifies the following input parameters:</p><ul>
<li><b>nimage</b>: Number of images (in total) in the reaction-path which is going to be optimized. In this case, we have 8; note that the number of images indicated here must be the same as in the input pathfile if <em>startfrompath = .TRUE.</em> (see below).</li>
<li><b>temperature</b>: We're going to use the <em>quickmin</em> optimization algorithm to refine our path (see below). In <em>quickmin</em>, each atom in each string is given a velocity to move it towards the MEP; these initial velocities are drawn from a Boltzmann distribution at the input temperature (in Kelvin) indicated here. For <em>quickmin</em> optimization, this temperature should be relatively low.</li>
<li><b>calctype</b>: Here, we're using <em>optpath</em> to indicate that we want to do a path optimization calculation.</li>
<li><b>pathfile</b>: In nudged elastic band path refinement calculations, we often have a good initial guess of the reaction path we'd like to refine. The <em>pathfile</em> variable defines the input file where our initial reaction-path guess is stored. In this case, we're saying that our initial reaction-path is in <em>path.xyz</em>; this is an <em>xyz</em> format file (with coordinates given in Angstroms) which MUST contain the same number of snapshots as the number <em>nimage</em> defined above.</li>
</ul>
<p><b>IMPORTANT: In this example, although we're showing how to define a starting <em>pathfile</em>, we're note actually going to use it! Instead, we've set <em>startfrompath .FALSE.</em>, which means that the initial path is instead going to be generated by linear interpolation of coordinates between the <em>startfile</em> and <em>endfile</em>.</b></p>
<ul>
<li><b>ranseed</b>: This is an integer random number seed, used to generate random initial velocities drawn from the Boltzmann distribution for <em>quickmin</em> (see above)</li>
<li><b>startfile</b>: This is an xyz file containing the reactant structure for our target system.</li>
<li><b>endfile</b>: This is an xyz file containing the product structure for out target system. <b>Note that the <em>startfile</em> and <em>endfile</em> MUST have the same number of atoms in the same order!</b></li>
<li><b>startfrompath</b>: Here, by inputting ".FALSE.", we're indicating that CDE should instead start by generating its own initial path by linear interpolation between <em>startfile</em> and <em>endfile</em>.</li>
</ul>
<p>The second input block (beginning with "# path optimization") defines parameters which control the NEB path refinement calculation:</p>
<ul>
<li><b>pathoptmethod</b>: We're setting this to <em>cineb</em>, to indicate that we'd like to run a CINEB calculation.</li>
<li><b>nebmethod</b>: This defines the optimization method we're using to find the minimum-energy path. Options are <em>quickmin</em>, which uses a velocity Verlet-based method, or <em>steepest</em> for a simple steepest-descent method. The <em>quickmin</em> method is preferred - it's usually much faster to converge.</li>
<li><b>nebiter</b>: This defines the mamximum number of CINEB iterations to perform before stopping. Note that if the calculation reaches a force convergence value lower than <em>nebconv</em> (see below), it stops anyway.</li>
<li><b>cithresh</b>: This is the force threshold at which the climbing-image variant of NEB (see references for details) is activated. In this case, once the current reaction-path forces are less than 0.008 Eh/a0, climbing-image is activated.</li>
<li><b>nebconv</b>: Target force convergence threshold for CINEB calculation.</li>
<li><b>nebspring</b>: CINEB sprin parameter (in atomic units, Eh/a0**2).</li>
<li><b>nebstep</b>: Step-length parameter for optimization. In the case of <em>quickmin</em>, this is an effective velocity Verlet time-step taken at each CINEB iteration (in atomic units, so a value of ~41 au corresponds to about a 1 fs time-step). In the case of steepest-descent (<em>nebmethod steepest</em>), the <em>nebstep</em> parameter indicates the fraction of the current force used to update the atomic coordinates at each step.</li>
<li><b>neboutfreq</b>: Frequency with which the NEB calculation will output the current reaction path and energy profile. The energy profiles are input to the file ending with *.nebprofile* and the paths are output to <em>input_YYYY.xyz</em>, where <em>YYYY</em> is the current NEB iteration.</li>
<li><b>stripinactive</b>: If set toe *.TRUE.*, then any molecules which are simply acting as "spectators" to the reaction (e.g. they are far away from the reaction sites and do not participate) are "stripped" (removed) from the reaction path BEFORE the NEB calculation. This option can make calculations a bit faster!</li>
<li><b>optendsbefore</b>: If set to *.TRUE.*, then CDE first performs a geometry optimization of the two end-point structures <em>before</em> procedding with CINEB.</li>
<li><b>optendsduring</b>: If set to *.TRUE.*, the two end-points are optimized under the action of the PES <em>during</em> the NEB optimization. Here, the end-points only feel the force due to the PES, and do not feel the NEB springs.</li>
<li><b>nebrestrend</b>: If <em>optendsduring = .TRUE.</em>, this options indicates whether or not to additionally include the graph-restraining potential into the forces felt by the two end-points during NEB optimization. This option can prevent the end-point molecules changing the connectivity during NEB optimization. Note that this option is only important if <em>optendsduring = .TRUE.</em>.</li>
<li><b>alignedatoms</b>: As described in the <em>annotated input file description</em> (<a class="el" href="../../d4/dfe/_annotated.html">Annotated input file description</a>), the <em>alignedatoms</em> directive tells CDE which triple of atoms should serve as coordinates to align and orient the NEB string in space, to avoid overall translation and rotation of the system during NEB refinement.</li>
</ul>
<p>The next input block (starting with "# constraints") indicate any constraints we'd like to impose on each image in the reaction-path during NEB optimization.</p>
<ul>
<li><b>atomconstraints</b>: In this example, we've indicated that there are no atom constraints (beyond the <em>alignedatoms</em> directive noted above).</li>
<li><b>dofconstraints</b>: Again, in this case, we don't have any DOF constraints other than those noted above.</li>
</ul>
<p>The final block (starting with "# PES input") defines options to enable potential energy evaluations and geometry optimization during the NEB calculation. These input parameters are discussed elsewhere, such as in <em>Annotated input file description</em> (<a class="el" href="../../d4/dfe/_annotated.html">Annotated input file description</a>).</p>
<h2><a class="anchor" id="autotoc_md25"></a>
start.xyz and end.xyz</h2>
<p>Here, the file <em>start.xyz</em> and <em>end.xyz</em> files contain the reactant and product structures for the initial reaction-path. These are xyz files, as described in <em>I/O formats</em> (<a class="el" href="../../d0/d74/formats.html">I/O structure formats</a>).</p>
<h2><a class="anchor" id="autotoc_md26"></a>
orca.head</h2>
<p>In the current calculation, we're going to use the <em>ab initio</em> code <em>ORCA</em> to perform potential energy and force evaluations.</p>
<p>Again, note that we could have called this file anything we wanted to - it doesn't have to be called <em>orca.head</em>. However, we must make sure that this is the same filename as defined in the <em>pesfil</em> variable in the input file above.</p>
<p>The <em>orca.head</em> file looks like this. </p><pre class="fragment">! PM3 ENGRAD
* xyz 0 1
XXX
*
</pre><p>Note that this file is exactly the same format as a usual <em>ORCA</em> input file:</p>
<ul>
<li>The first line tells <em>ORCA</em> to run an <em>energy and gradient</em> evaluation using the <em>PM3</em> semi-empirical method.</li>
<li>The second line begins the geometry specification; here, we're indicating that the geometry will be specified as <em>xyz</em> Cartesian coordinates (in Angstroms), the total charge on the system is <em>0</em>, and the total spin multiplicity is <em>1</em> (i.e. closed-shell species).</li>
<li>In a normal <em>ORCA</em> file, we would then input the geometry on the following lines. For example, an <em>ORCA</em> input file would look like this: <pre class="fragment">  ! PM3 ENGRAD
  * xyz 0 1
  C 0.1500  0.2166 0.007
  O 1.56  1.679  5.7098
  *
</pre></li>
<li>However, in an input file for CDE, the coordinate block is simply replaced by the string <em>XXX</em>. This indicates that this is the point at which <em>CDE</em> should insert coordinates for molecules it would like to run through <em>ORCA</em>.</li>
<li>Finally, there is a "*" symbol on the last line to indicate that this is the end of the <em>ORCA</em> input file.</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
orca.min</h2>
<p>Like the <em>orca.head</em> file, the file defined as <em>pesoptfile</em> should also be present in the directory.</p>
<p>This file indicates how to run a geometry optimization calculation; note that this calculation is only used if <em>optendsbefore = .TRUE.</em>.</p>
<p>As in the case of the files above, the <em>pesoptfile</em> can be called anything you'd like!</p>
<p>The format of the <em>pesoptfile</em> (here called <em>orca.min</em>) is the same as an <em>ORCA</em> file for a geometry optimization, but again with the condition that the coordinate input block is replaced by <em>XXX</em>. An example is: </p><pre class="fragment">! PM3 OPT TightSCF
* xyz 0 1
XXX
*
</pre><p>Note that everything in the file above is the normal <em>ORCA</em> format; the only difference is the <em>XXX</em> line required by CDE.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
A note on executables for external programs</h2>
<p>Note that our input file above contains two variables defined as: </p><pre class="fragment">  pesexecutable orca
  pesoptexecutable orca
</pre><p>The <em>pesexecutable</em> and <em>pesoptexecutable</em> variables indicate which code to run to calculate energies and forces; in this case, we're using <em>ORCA</em>.</p>
<p>Note that, in each case, the input command is run directly. For example, based on the above, CDE will run the following command when an <em>ORCA</em> calculation is required: </p><pre class="fragment">orca temp.in
</pre><p>where <em>temp.in</em> is the name of a temporary input file which is auto-generated by CDE during NEB calculations.</p>
<p><b>If there is no executable called "orca", the CDE calculation will fail!</b></p>
<p>To make sure everything runs smoothly, there are two options:</p>
<p>(1) You can set up an alias so that, when CDE executes the command <em>orca</em> given as <em>pesexecutable</em> and <em>pesoptexecutable</em>, everything runs as expected. For example, lets say you have <em>ORCA</em> installed in *~/programs/stuff/orca/bin/*. If you include an alias in your *.bashrc* (or similar config file if you're on a different system) which reads </p><pre class="fragment">alias orca='~/programs/stuff/orca/bin/orca'
</pre><p>then running the command <em>orca</em> will then execute *~/programs/stuff/orca/bin/orca*, which should indeed correspond to an executable binary.</p>
<p>(2) As an alternative, you can also give the full pathname to the deisred executable directly in the input file, lik this: </p><pre class="fragment">  pesexecutable ~/programs/stuff/orca/bin/orca
  pesoptexecutable ~/programs/stuff/orca/bin/orca
</pre><h2><a class="anchor" id="autotoc_md29"></a>
Running the calculation</h2>
<p>With these input files, we are now able to run the CINEB optimization. To do so, go into the *~/cde/examples/cineb/* directory and type: </p><pre class="fragment">cde.x input
</pre><p>The above assumes that you have already made sure that CDE can be run by simply typing <em>cde.x</em>. See the <a class="el" href="../../d0/d7d/setup.html">setup section</a> for more details.</p>
<p>As the calculation runs, you will find lots of output files generated in the run directory. Many of these files will be useless outputs generated by <em>ORCA</em>, typically ocntaining wavefunction and integration grid information.</p>
<p>The interesting output files are as follows:</p>
<ul>
<li><b>input.nebconv</b>: This file shows the total norm of the forces, averaged over the images. These values are given for calculations performed with and without the NEB spring terms. This file can be monitored during the calculation to find out how close to convergence the NEB calculation is. This file is written after every NEB iteration.</li>
<li><b>input.nebprofile</b>: This file contains the energy profile along the reaction-string at the different iterations of the NEB calculation; both absolute energy and relative energy are given. This file is output every **neboutfreq* steps of the NEB optimization.</li>
<li><b>input_YYYY.xyz</b>: These files contain the refined path at NEB iteration <em>YYYY</em>. These files are output every <em>neboutfreq</em> steps of the NEB optimization, and are in standard XYZ format. They can be visualized in <em>VMD</em> or <em>Avogadro</em>.</li>
<li><b>input.energy-neb-start</b>: This contains the energy profile of the reaction string at the start of the calculation.</li>
<li><b>input.energy-neb-end</b>: This contains the energy profile of the reaction string at the end of the calculation.</li>
</ul>
<p>In addition to the above ouptut files, the *.log file produced by all CDE calculations will also contain some useful information about the NEB run.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
Next steps</h2>
<p>Possible further steps include:</p>
<ul>
<li>Performing geometry optimization, followed by frequency calculations, for the reaction-path end-points in order to calculate the free energies using the harmonic oscillator/rigid rotor approximation.</li>
<li>Finding the transition state for the reaction, using the image nearest to the top of the reaction-barrier obtained by NEB.</li>
<li>Using all of the above information to calculte the transition-state theory rate constant. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
