<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CDE: pathfinder Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CDE
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Chemistry Discovery Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacepathfinder.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">pathfinder Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains routines for automatic determination of a reaction-mechanism connecting two distinct (user-input) structures.  
<a href="namespacepathfinder.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7ce0d0c193755a13466c3a5c273b21d2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a7ce0d0c193755a13466c3a5c273b21d2">runpathfinder</a> ()</td></tr>
<tr class="memdesc:a7ce0d0c193755a13466c3a5c273b21d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">RunPathFinder.  <a href="namespacepathfinder.html#a7ce0d0c193755a13466c3a5c273b21d2">More...</a><br /></td></tr>
<tr class="separator:a7ce0d0c193755a13466c3a5c273b21d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a653856562ee8b080c5577efcf618ce58"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a653856562ee8b080c5577efcf618ce58">adjustpaths</a> (cx_start, cx_end, cx, nrxn, movenum, moveatoms, ifound)</td></tr>
<tr class="memdesc:a653856562ee8b080c5577efcf618ce58"><td class="mdescLeft">&#160;</td><td class="mdescRight">AdjustPaths.  <a href="namespacepathfinder.html#a653856562ee8b080c5577efcf618ce58">More...</a><br /></td></tr>
<tr class="separator:a653856562ee8b080c5577efcf618ce58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ab181b5ba41de2c9bb6d9eddeafb915"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a5ab181b5ba41de2c9bb6d9eddeafb915">containstargetatom</a> (cx1, mol1, cx2, itarget)</td></tr>
<tr class="memdesc:a5ab181b5ba41de2c9bb6d9eddeafb915"><td class="mdescLeft">&#160;</td><td class="mdescRight">ContainsTargetAtom.  <a href="namespacepathfinder.html#a5ab181b5ba41de2c9bb6d9eddeafb915">More...</a><br /></td></tr>
<tr class="separator:a5ab181b5ba41de2c9bb6d9eddeafb915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac162e64b047281f6a8040365318bf631"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#ac162e64b047281f6a8040365318bf631">evaluategrapherror</a> (cx, cx_end, error, errflag)</td></tr>
<tr class="memdesc:ac162e64b047281f6a8040365318bf631"><td class="mdescLeft">&#160;</td><td class="mdescRight">EvaluateGraphError.  <a href="namespacepathfinder.html#ac162e64b047281f6a8040365318bf631">More...</a><br /></td></tr>
<tr class="separator:ac162e64b047281f6a8040365318bf631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de07862cb4c5d601bd783c1bb17aace"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a0de07862cb4c5d601bd783c1bb17aace">comparegraphs</a> (cx1, cx2, error)</td></tr>
<tr class="memdesc:a0de07862cb4c5d601bd783c1bb17aace"><td class="mdescLeft">&#160;</td><td class="mdescRight">CompareGraphs.  <a href="namespacepathfinder.html#a0de07862cb4c5d601bd783c1bb17aace">More...</a><br /></td></tr>
<tr class="separator:a0de07862cb4c5d601bd783c1bb17aace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff32d131039907ab2149ee86575c84b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#aeff32d131039907ab2149ee86575c84b">propagategraphs</a> (cx_start, cx, nrxn, movenum, moveatoms, errflag, error)</td></tr>
<tr class="memdesc:aeff32d131039907ab2149ee86575c84b"><td class="mdescLeft">&#160;</td><td class="mdescRight">PropagateGraphs.  <a href="namespacepathfinder.html#aeff32d131039907ab2149ee86575c84b">More...</a><br /></td></tr>
<tr class="separator:aeff32d131039907ab2149ee86575c84b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3176a0a22cdd34dd1b20fb26be06d66"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#ad3176a0a22cdd34dd1b20fb26be06d66">selectmoveatoms</a> (imove, moveatoms, nrxn, irx, rxindex, nrx, fail, atomchange, bondchange, na, cx, cx_start)</td></tr>
<tr class="memdesc:ad3176a0a22cdd34dd1b20fb26be06d66"><td class="mdescLeft">&#160;</td><td class="mdescRight">SelectMoveAtoms.  <a href="namespacepathfinder.html#ad3176a0a22cdd34dd1b20fb26be06d66">More...</a><br /></td></tr>
<tr class="separator:ad3176a0a22cdd34dd1b20fb26be06d66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de94873987728e50c19bae54729c3cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a2de94873987728e50c19bae54729c3cd">pathbondenergy</a> (cx_start, cx, nrxn, vbe, movenum, errflag)</td></tr>
<tr class="memdesc:a2de94873987728e50c19bae54729c3cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">PathBondEnergy.  <a href="namespacepathfinder.html#a2de94873987728e50c19bae54729c3cd">More...</a><br /></td></tr>
<tr class="separator:a2de94873987728e50c19bae54729c3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc50ac9bfc47024caf9ef5fb5dcba547"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#acc50ac9bfc47024caf9ef5fb5dcba547">getpathfitness</a> (cx_start, cx_end, cx, nrxn, movenum, moveatoms, errflag, GraphError, TotalError, vbe)</td></tr>
<tr class="memdesc:acc50ac9bfc47024caf9ef5fb5dcba547"><td class="mdescLeft">&#160;</td><td class="mdescRight">GetPathFitness.  <a href="namespacepathfinder.html#acc50ac9bfc47024caf9ef5fb5dcba547">More...</a><br /></td></tr>
<tr class="separator:acc50ac9bfc47024caf9ef5fb5dcba547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f3ea0bd66b1f1ebcea3cce7c677f9b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a20f3ea0bd66b1f1ebcea3cce7c677f9b">trimpath</a> (cx_start, cx_end, cx, nrxn, movenum, moveatoms, iend)</td></tr>
<tr class="memdesc:a20f3ea0bd66b1f1ebcea3cce7c677f9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">TrimPath.  <a href="namespacepathfinder.html#a20f3ea0bd66b1f1ebcea3cce7c677f9b">More...</a><br /></td></tr>
<tr class="separator:a20f3ea0bd66b1f1ebcea3cce7c677f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2637ab51295387ae866c2c51e5776d49"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a2637ab51295387ae866c2c51e5776d49">printmolsalongpath</a> (nrxn, cx_start, cx_end, cx, movenum, chargemove, changecharges, moveatoms)</td></tr>
<tr class="memdesc:a2637ab51295387ae866c2c51e5776d49"><td class="mdescLeft">&#160;</td><td class="mdescRight">PrintMolsAlongPath.  <a href="namespacepathfinder.html#a2637ab51295387ae866c2c51e5776d49">More...</a><br /></td></tr>
<tr class="separator:a2637ab51295387ae866c2c51e5776d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb04da4443080b8f2061719fee556f3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a6bb04da4443080b8f2061719fee556f3">graphstocoords</a> (cx_start, cx, nrxn, printflag, printfile)</td></tr>
<tr class="memdesc:a6bb04da4443080b8f2061719fee556f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">GraphsToCoords.  <a href="namespacepathfinder.html#a6bb04da4443080b8f2061719fee556f3">More...</a><br /></td></tr>
<tr class="separator:a6bb04da4443080b8f2061719fee556f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93493afafe94aa6c6c7231b969a5711d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a93493afafe94aa6c6c7231b969a5711d">printmechanismpaths</a> (nrxn, cx_start, cx, file_root, maxbarrier, bsum, movenum)</td></tr>
<tr class="memdesc:a93493afafe94aa6c6c7231b969a5711d"><td class="mdescLeft">&#160;</td><td class="mdescRight">PrintMechanismPaths.  <a href="namespacepathfinder.html#a93493afafe94aa6c6c7231b969a5711d">More...</a><br /></td></tr>
<tr class="separator:a93493afafe94aa6c6c7231b969a5711d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a57e9848ee768d8e19891d5fa91ff0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a38a57e9848ee768d8e19891d5fa91ff0">updatemechanism</a> (nrxn, movenum, moveatoms, bondchange, atomchange, na, cx_start, cx, rxindex, cyc, movenum_store, moveatoms_store)</td></tr>
<tr class="memdesc:a38a57e9848ee768d8e19891d5fa91ff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpdateMechanism.  <a href="namespacepathfinder.html#a38a57e9848ee768d8e19891d5fa91ff0">More...</a><br /></td></tr>
<tr class="separator:a38a57e9848ee768d8e19891d5fa91ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc92aeaed8e180333ae25bda3b93026"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#afbc92aeaed8e180333ae25bda3b93026">reactionerrorcorrection</a> (cx_start, cx, nrxn, movenum, moveatoms, errx)</td></tr>
<tr class="memdesc:afbc92aeaed8e180333ae25bda3b93026"><td class="mdescLeft">&#160;</td><td class="mdescRight">ReactionErrorCorrection.  <a href="namespacepathfinder.html#afbc92aeaed8e180333ae25bda3b93026">More...</a><br /></td></tr>
<tr class="separator:afbc92aeaed8e180333ae25bda3b93026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588e5149dd38beb79af3aa90f907cd72"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepathfinder.html#a588e5149dd38beb79af3aa90f907cd72">updatecharges</a> (nrxn, cx, chargemove, chargemove_store, errflag)</td></tr>
<tr class="memdesc:a588e5149dd38beb79af3aa90f907cd72"><td class="mdescLeft">&#160;</td><td class="mdescRight">UpdateCharges.  <a href="namespacepathfinder.html#a588e5149dd38beb79af3aa90f907cd72">More...</a><br /></td></tr>
<tr class="separator:a588e5149dd38beb79af3aa90f907cd72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains routines for automatic determination of a reaction-mechanism connecting two distinct (user-input) structures. </p>
<p>The method employed here has been reported in:</p>
<p>Automatic Proposal of Multistep Reaction Mechanisms using a Graph-Driven Search, I. Ismail and H. B. V. A. Stuttaford-Fowler and C. Ochan Ashok and C. Robertson and S. Habershon, J Phys Chem A&#160; 123&#160; 3407-3417&#160; (2019)</p>
<p>Fast screening of homogeneous catalysis mechanisms using graph-driven searches and approximate quantum chemistry, C Robertson, S Habershon, Catalysis Science &amp; Technology, 9, 6357 (2019)</p>
<p>Bibtex records:</p>
<p>@article{Habershon:2019ab, Author = {Ismail, Idil and Stuttaford-Fowler, Holly B V A and Ochan Ashok, Curtis and Robertson, Christopher and Habershon, Scott}, Journal = {J Phys Chem A}, Month = {Apr}, Number = {15}, Pages = {3407-3417}, Title = {Automatic Proposal of Multistep Reaction Mechanisms using a Graph-Driven Search}, Volume = {123}, Year = {2019}}</p>
<p>@article{Habershon:2019ee, Author = {Robertson, Christopher and Habershon, Scott}, Date-Added = {2019-12-03 15:41:20 +0000}, Date-Modified = {2019-12-03 15:41:29 +0000}, Doi = {10.1039/C9CY01997A}, Issue = {22}, Journal = {Catal. Sci. Technol.}, Pages = {6357-6369}, Publisher = {The Royal Society of Chemistry}, Title = {Fast screening of homogeneous catalysis mechanisms using graph-driven searches and approximate quantum chemistry}, Url = {<a href="http://dx.doi.org/10.1039/C9CY01997A">http://dx.doi.org/10.1039/C9CY01997A</a>}, Volume = {9}, Year = {2019}, }</p>
<hr  />
 <h2><a class="anchor" id="autotoc_md38"></a>
DESCRIPTION</h2>
<p>Given input xyz files for target reactants and products, this routine will try to find a reaction mechanism connecting the two by using graph-moves defined in the "movefile".</p>
<p>After determination of a path which definitively connects reactants and products, we then generate xyz-files for each reaction-path along the reaction-mechanism using the idea of optimization under the graph-restraining potential.</p>
<p>If optaftermove = .TRUE. in the input file, this code will also perform geometry optimization for all of the intermediate structures and report the results in the .log file.</p>
<hr  />
 <h2><a class="anchor" id="autotoc_md40"></a>
OUTPUTS</h2>
<p>After completion, the following outputs are worth looking at:</p><ul>
<li>mcopt.dat: contains the graph-error function as a function of number of MC iterations in the calculation. This should reach zero for a successful calculation.</li>
<li>final_path.xyz: Contains the intermediate structures (xyz format) along the located reaction mechanism. If optaftermove = .true., the structures are geometry-optimized using whichever electronic structure methods is specified in the input file.</li>
<li>final_path_rx_*.xyz: This series of xyz files, one for each reaction-step in the mechanism, contain initial nimage-long paths for each intermediate reaction.</li>
<li>.log: The .log file will contain useful information about the reaction, including the calculated Q-value and the maximum dE value.</li>
</ul>
<p>In addition, if igfunc = 4 (so we are targetting formation of a single molecule or subset of molecules, rather than an entire structure), the further outputs are produced which have the prefix 'adjusted_'. This are files which have been determined for the reaction path after removing molecules and reactions which are not relevant to the formation of the product. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7ce0d0c193755a13466c3a5c273b21d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce0d0c193755a13466c3a5c273b21d2">&#9670;&nbsp;</a></span>runpathfinder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::runpathfinder</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RunPathFinder. </p>
<p>Runs automatic determination of a reaction-path connecting two structures. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l00108">108</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a653856562ee8b080c5577efcf618ce58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a653856562ee8b080c5577efcf618ce58">&#9670;&nbsp;</a></span>adjustpaths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::adjustpaths </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ifound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>AdjustPaths. </p>
<p>This routine performs a series of functions to simplify the post-analysis of reaction-path simulations. (i) If pesfull = .FALSE., we print out the energies and Q-values calculated only for those molecules involved in formation of the product. (ii) We print out a new set of reaction paths which only involve the molecules containing atoms ending up in the final structure. (iii) We strip the adjusted paths of non-reactive molecules.</p>
<p>The final set of xyz path files should then be most appropriate for post-analysis.</p>
<p>Input parameters:</p><ul>
<li>cx_start: CXS object for reactants.</li>
<li>cx_end: CXS object for target product.</li>
<li>cx(nrxn): Intermediate CXS objects along mechanism path.</li>
<li>nrxn: Maximum number of active reactions.</li>
<li>movenum(:): Graph-move number at each reaction step.</li>
<li>moveatoms(:,:): Atoms involved in graph-moves at each step.</li>
<li>ifound: Reaction step-number at which target products are first found. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l00507">507</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a5ab181b5ba41de2c9bb6d9eddeafb915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ab181b5ba41de2c9bb6d9eddeafb915">&#9670;&nbsp;</a></span>containstargetatom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function pathfinder::containstargetatom </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>mol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>itarget</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ContainsTargetAtom. </p>
<p>Logical function to check whether cx1 contains any of the atoms in molecule number "itarget" in cx2. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l00997">997</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="ac162e64b047281f6a8040365318bf631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac162e64b047281f6a8040365318bf631">&#9670;&nbsp;</a></span>evaluategrapherror()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::evaluategrapherror </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>errflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>EvaluateGraphError. </p>
<p>Calculates the error measure between the final graph cx and the target graph cx_end. The error is defines as the sum of squared differences for each graph element. If errflag = .TRUE., it means that the reaction path itself is not valid and we assign it and arbitrarily large error.</p>
<p>cx - Final graph in reaction string. cx_end - Target graph for reaction string. error - Calculated graph error. errflag - Logical flag indicating whether the reaction string is valid or not. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l01032">1032</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a0de07862cb4c5d601bd783c1bb17aace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0de07862cb4c5d601bd783c1bb17aace">&#9670;&nbsp;</a></span>comparegraphs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::comparegraphs </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CompareGraphs. </p>
<p>Compare two separate structures via their graphs. In particular, we compare the eigenvalues of the atomic-weighted graph Coulomb matrix, with the distances between atoms given by the shortest-path distances as calculated from the graph.</p>
<p>cx1, cx2 - Two structures to compare. Note that the graphs MUST have been already calculated. error - Calculate mean-square error between eigenvalues. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l01075">1075</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="aeff32d131039907ab2149ee86575c84b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeff32d131039907ab2149ee86575c84b">&#9670;&nbsp;</a></span>propagategraphs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::propagategraphs </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>errflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PropagateGraphs. </p>
<p>Using the string of nrxn graph moves and their atom labels, this routine starts from the connectivity graph of cx_start and generates the sequence of nrxn graphs.</p>
<p>cx_start - Chemical structure object, contains the starting graph. cx(1:nrxn) - Sequence of chemical structure objects generated by graph moves. nrxn - Number of moves in the reaction string. movenum(:) - Integer move number for reaction i. moveatoms(:,:) - Indices of atoms involved in move i. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l01441">1441</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="ad3176a0a22cdd34dd1b20fb26be06d66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3176a0a22cdd34dd1b20fb26be06d66">&#9670;&nbsp;</a></span>selectmoveatoms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::selectmoveatoms </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>imove</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>irx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(namax)&#160;</td>
          <td class="paramname"><em>rxindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>fail</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(na)&#160;</td>
          <td class="paramname"><em>atomchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(na,na)&#160;</td>
          <td class="paramname"><em>bondchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SelectMoveAtoms. </p>
<p>For move number imove, this subroutine selects new atoms for the move using the pre-defined list of reactive atom indices in rxindex.</p>
<p>imove - A given movenumber. This corresponds to the index of a move in the movefile. moveatoms(nrx,NAMOVEMAX) - Indices of atoms which are moved during a given graph-move. nrxn - Number of reactions in string. irxn - The reaction number which we're trying to change. rxindex(MAMAX) - Indices of reactive atoms in current graph. This array must be previously determined using SetReacctiveIndices() from module gds. nrx - Number of reactive atoms stored in rxindex(:). fail - logical flag indicating whether or not this subroutine has successfully managed to find new atoms for the move imove. atomchange(na) - Logical array indicating which atoms can react. bondchange(na,na) - Logical array indicating which bonds can change. na - Number of atoms. cx(nrxn) - Chemical structure objects for each node in reaction string. cx_start - Chemical structure object for start configuration. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l01703">1703</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a2de94873987728e50c19bae54729c3cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de94873987728e50c19bae54729c3cd">&#9670;&nbsp;</a></span>pathbondenergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::pathbondenergy </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>vbe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>errflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PathBondEnergy. </p>
<p>Using a simple additive model, calculate the bonding energy along the entire path, using typical bond energies....</p>
<p>cx_start - Starting chemical structure. cx(:) - The set of structures along the path. nrxn - Number of reactions in string. vbe - Returned additive energy. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l01926">1926</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="acc50ac9bfc47024caf9ef5fb5dcba547"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc50ac9bfc47024caf9ef5fb5dcba547">&#9670;&nbsp;</a></span>getpathfitness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::getpathfitness </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>errflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>GraphError</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>TotalError</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>vbe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GetPathFitness. </p>
<p>Calculate the fitness value associated with a given reaction mechanism.</p>
<p>This TotalError is defined as the sum of a GraphError, describing how far away a propagated graph is from a target graph, as well as a vbe contribution which includes energy contributions to the path fitness.</p>
<p>Note that the energy contribution is only calculated when alphavbe &gt; 1d-3.</p>
<p>cx_start - The chemical structure object for the reactants. cx_end - The chemical structure object for the products. cx(:) - Chemical structure objects for intermediates along path. nrxn - Number of reactions in path. novenum(nrxn) - Move numbers for each reaction in the path. moveatomos(nrxn,NAMOVEMAX) - Atoms which are acted upon in each reaction. errflag - Logical flag indicating whether or not a chemically-sensible reaction path has been generated. GraphError - Error term arising due to differences between propagated graph and target graph. TotalError - GraphError + alphavbe * vbe. vbe - Calculated bonding energy. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02068">2068</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a20f3ea0bd66b1f1ebcea3cce7c677f9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f3ea0bd66b1f1ebcea3cce7c677f9b">&#9670;&nbsp;</a></span>trimpath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::trimpath </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TrimPath. </p>
<p>When the target molecule is detected in a reaction, the rest of the movenums are set to zero. In other words, if the target is found at some reaction step before the end, we then set the rest of the reactions to zero because we don't care what they are any more..</p>
<p>cx_start - The chemical structure object for the reactants. cx_end - The chemical structure object for the products. cx(:) - Chemical structure objects for intermediates along path. nrxn - Number of reactions in path. novenum(nrxn) - Move numbers for each reaction in the path. moveatoms(nrxn,NAMOVEMAX) - Atoms which are acted upon in each reaction. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02118">2118</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a2637ab51295387ae866c2c51e5776d49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2637ab51295387ae866c2c51e5776d49">&#9670;&nbsp;</a></span>printmolsalongpath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::printmolsalongpath </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,nmolmax)&#160;</td>
          <td class="paramname"><em>chargemove</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>changecharges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PrintMolsAlongPath. </p>
<p>Outputs (to logfile) the molecular structure present at each step along a reaction-mechanism,so that the user can get a feel for what is going on in the path.</p>
<p>nrxn - Number of reactions in path. cx_start - The chemical structure object for the reactants. cx_end - The chemical structure object for the products. cx(:) - Chemical structure objects for intermediates along path. movenum(nrxn) - Move numbers for each reaction in the path. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02176">2176</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a6bb04da4443080b8f2061719fee556f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb04da4443080b8f2061719fee556f3">&#9670;&nbsp;</a></span>graphstocoords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::graphstocoords </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>printflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*)&#160;</td>
          <td class="paramname"><em>printfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GraphsToCoords. </p>
<p>Converts a sequence of connectivity graphs to xyz coordinates by optimization under the action of the graph-restraining potential.</p>
<p>The coordinates of the reactant structure are contained in cx_start; these are used as the starting point for a sequence of geometry optimizations. The resulting structures obey the target bonding graph at each step.</p>
<p>If optaftermove = .TRUE. in the input file, then geometry optimization of the structures is also performed AFTER graph-potential optimization.</p>
<p>cx_start - Chemical structure object for reactants. cx(nrxn) - Chemical structures along the path. nrxn - Number of reactions along the path. printflag - Logical flag indicating whether to print out xyz files or not. printfile - If printflag = .TRUE., printfile indicates the file to print to. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02244">2244</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a93493afafe94aa6c6c7231b969a5711d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93493afafe94aa6c6c7231b969a5711d">&#9670;&nbsp;</a></span>printmechanismpaths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::printmechanismpaths </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len=20)&#160;</td>
          <td class="paramname"><em>file_root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>maxbarrier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>bsum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxnmax)&#160;</td>
          <td class="paramname"><em>movenum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PrintMechanismPaths. </p>
<p>Prints out nimage intermediate snapshots for each of the generated reactions in the final reaction-path.</p>
<p>Note that the end-point coordinates for each reaction are assumed to be stored in cx_start and cx(nrxn).</p>
<p>We use linear interpolation between these end-points to generate internal images.</p>
<p>The results are stored to the files final_path_rx_*.xyz.</p>
<p>nrxn - Number of reactions in mechanism. cx_start - Chemical structure object for reactants. cx(nrxn) - Chemical structure objects for products of each reaction. These come from the subroutine GraphsToCoords(). file_root - Root name of printing file. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02433">2433</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a38a57e9848ee768d8e19891d5fa91ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a57e9848ee768d8e19891d5fa91ff0">&#9670;&nbsp;</a></span>updatemechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::updatemechanism </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(na,na)&#160;</td>
          <td class="paramname"><em>bondchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(na)&#160;</td>
          <td class="paramname"><em>atomchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>na</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(namax)&#160;</td>
          <td class="paramname"><em>rxindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>cyc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms_store</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpdateMechanism. </p>
<p>Performs a trial move by modifying a current mechanism string by either changing a move and its atoms, or just changing the atoms of an exisiting move.</p>
<p>Note that the end-point coordinates for each reaction are assumed to be stored in cx_start and cx(nrxn).</p>
<p>nrxn - Number of reactions in mechanism. cx_start - Chemical structure object for reactants. cx(nrxn) - Chemical structure objects for products of each reaction. These come from the subroutine GraphsToCoords(). </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02538">2538</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="afbc92aeaed8e180333ae25bda3b93026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc92aeaed8e180333ae25bda3b93026">&#9670;&nbsp;</a></span>reactionerrorcorrection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::reactionerrorcorrection </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>)&#160;</td>
          <td class="paramname"><em>cx_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn)&#160;</td>
          <td class="paramname"><em>movenum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,namovemax)&#160;</td>
          <td class="paramname"><em>moveatoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>errx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ReactionErrorCorrection. </p>
<p>Performs error correction using geometry-optimized structures, making sure that the reactions listed in movenum and moveatoms are actually correct for a given reaction string.</p>
<p>Note that the end-point coordinates for each reaction are assumed to be stored in cx_start and cx(nrxn). </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l02704">2704</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
<a id="a588e5149dd38beb79af3aa90f907cd72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a588e5149dd38beb79af3aa90f907cd72">&#9670;&nbsp;</a></span>updatecharges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pathfinder::updatecharges </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nrxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structchemstr_1_1cxs.html">cxs</a>), dimension(nrxn)&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,nmolmax)&#160;</td>
          <td class="paramname"><em>chargemove</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrxn,nmolmax)&#160;</td>
          <td class="paramname"><em>chargemove_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>errflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UpdateCharges. </p>
<p>Update the charges on molecules along the reaction path. These moves are performed in addition to reaction changes. </p>

<p class="definition">Definition at line <a class="el" href="pathfinder_8f90_source.html#l03014">3014</a> of file <a class="el" href="pathfinder_8f90_source.html">pathfinder.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacepathfinder.html">pathfinder</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
