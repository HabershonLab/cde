<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: PES evaluations</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../test.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('da/dfe/_p_e_s.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PES evaluations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>CDE can call several external programs to obtain energies and forces on atoms during GDS and NEB runs. This section describes how this is managed, and how input files can be set-up to run different external codes.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
PES types</h1>
<ul>
<li>The potential energy surface (PES) type to be used during a CDE-based calculation is indicated through the variables <b>pestype</b> and <b>pesopttype</b>.</li>
<li>The <b>pestype</b> is used whenever the code requires a single-point energy evaluation.</li>
<li>The current allowed values of <b>pestype</b> are (see pes.f90):<ul>
<li><em>orca</em>: Performs a calculation using the quantum chemical program ORCA (<a href="https://orcaforum.cec.mpg.de">https://orcaforum.cec.mpg.de</a>)</li>
<li><em>dftb</em>: Performs a calculation using the density-functional tight-binding code DFTB+ (<a href="https://www.dftbplus.org">https://www.dftbplus.org</a>)</li>
<li><em>psi4</em>: Performs a calculation using the psi-4 quantum code (<a href="http://www.psicode.org">http://www.psicode.org</a>)</li>
<li><em>lammps</em>: Performs a calculation of the PES using the LAMMPS simulation package (<a href="https://lammps.sandia.gov">https://lammps.sandia.gov</a>)</li>
<li><em>null</em>: Does not perform a PES evaluation. Simply returns V = 0 and forces(:) = 0 for all atoms.</li>
</ul>
</li>
<li>The <b>pesopttype</b> is used whenever the code requires a geometry optimization.</li>
<li>The allowed values of <b>pesopttype</b> are:<ul>
<li><em>orca</em>: ORCA calculation.</li>
<li><em>dftb</em>: DFTB+ calculation.</li>
<li><em>psi4</em>: Psi-4 calculation.</li>
<li><em>lammps</em>: LAMMPS calculation.</li>
<li><em>uff</em>: Performs geometry optimization under the UFF (Universal force-field) as implemented in babel/openbabel (<a href="http://openbabel.org/wiki/Main_Page">http://openbabel.org/wiki/Main_Page</a>)</li>
<li><em>null</em>: Does not perform geometry optimization.</li>
</ul>
</li>
<li>To add new PES evaluation types, you need to edit the files pes.f90 and io.f90; <b>DO NOT DO THIS UNLESS YOU ARE SURE YOU KNOW WHAT YOU ARE DOING!</b></li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
PES and geometry optimization executables</h1>
<p>As well as knowing which type of PES calculation you'd like, the CDE code needs to know <em>how</em> to run the external executables which are requested to calculate potential energies and forces, or to run geometry optimizations.</p>
<p>The executables to be used to energy evaluations or geometry optimization are defined in the variables <em>pesexecutable</em> and <em>pesoptexecutable</em>, as follows: </p><pre class="fragment">pesexecutable ~/programs/orca
pesoptexecutable ~/programs/orca
</pre><p>In the example above, we're are indicating that the external program to be used is <em>orca</em>, and this is stored in the directory *~/programs/*.</p>
<p>Internally, CDE runs FORTRAN <em>EXECUTE_COMMAND_LINE</em> calls to run external codes, using input files generated according to templates provided as <em>pesfile</em> and <em>pesoptfile</em> (see below).</p>
<p>For example, based on the above, CDE will run the following command when an <em>ORCA</em> calculation is required: </p><pre class="fragment">~/programs/orca temp.in
</pre><p>where <em>temp.in</em> is the name of a temporary input file which is auto-generated by CDE during NEB calculations.</p>
<p><b>If there is no executable called "~/programs/orca", the CDE calculation will fail!</b></p>
<p>To make sure everything runs smoothly, there are two useful options:</p>
<p>(1) You can set up an alias for each executable, then provide the alias as <em>pesexecutable</em> and <em>pesoptexecutable</em>. For example, lets say you have <em>ORCA</em> installed in *~/programs/stuff/orca/bin/*. If you include an alias in your *.bashrc* (or similar config file if you're on a different system) which reads </p><pre class="fragment">alias orca='~/programs/stuff/orca/bin/orca'
</pre><p>then running the command <em>orca</em> will then execute *~/programs/stuff/orca/bin/orca*, which should indeed correspond to an executable binary.</p>
<p>This means that you can then use the following in your CDE input files:</p>
<pre class="fragment">pesexecutable orca
pesoptexecutable orca
</pre><p>without having to provide the full path to the executables.</p>
<p>(2) As an alternative, you can also give the full pathname to the desired executable directly in the input file, lik this: </p><pre class="fragment">  pesexecutable ~/programs/stuff/orca/bin/orca
  pesoptexecutable ~/programs/stuff/orca/bin/orca
</pre><h1><a class="anchor" id="autotoc_md9"></a>
PES template files</h1>
<ul>
<li>The final pieces of information which CDE requires in order to perform energy evaluations or geometry optimization is a PES <em>template file</em>.</li>
<li>The input parameters <b>pesfile</b> and <b>pesoptfile</b> are header files which are used to direct external codes which calculation to perform when they are called by CDE. These header files must have the same format as input files required by the <em>pesexecutable</em> and <em>pesoptexecutable</em>.</li>
<li>The only difference is that there must be a line with <em>XXX</em> as follows:</li>
</ul>
<pre class="fragment">    XXX
</pre><ul>
<li>The <em>XXX</em> tells the CDE code where it should insert the coordinates of the configuration at which the energy evaluation is requested. After inserting the coordinates, CDE writes the input file then runs the relevant external executable to evaluate the energy. Once the energy evaluation (or geometry optimization) is complete, CDE reads in the results.</li>
<li>The file pes.f90 can be consulted to see how this write/run/read process works for each external code.</li>
<li>An example header file for a PES evaluation by ORCA using PM3 semi-empirical method might be as follows:</li>
</ul>
<pre class="fragment">! PM3
* xyz 0 1
XXX
*
</pre><ul>
<li>An example header file for PES evaluation by DFTB+ might be as follows:</li>
</ul>
<pre class="fragment"> Geometry = GenFormat {
XXX
}
Driver = {}
 Hamiltonian = DFTB {
 SCC = Yes
 SCCTolerance = 1e-3
 Mixer = Broyden{}
 Eigensolver = RelativelyRobust {}
MaxAngularMomentum {
 C = "p"
O = "p"
H = "s"
 }
SlaterKosterFiles = Type2FileNames {
Prefix = "/Users/scott/code/cde/src/SKfiles/"
 Separator = "-"
 Suffix = ".skf"
 }
}
Analysis = {
CalculateForces = Yes
 }
</pre><ul>
<li>Note in the above examples that the only part of the file which is written by CDE is in replacing the <em>XXX</em> with the coordinates at which the energy evaluation is being performed. All other aspects, such as the calculation type (e.g. DFT, Hartree-Fock, semi-empirical, DFTB+), basis sets, accuracy, and so on, are controlled by editing the <em>pesfile</em> and <em>pesoptfile</em> BEFORE the calculation starts. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
